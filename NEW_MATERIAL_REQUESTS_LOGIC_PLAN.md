# üìã –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ù–û–í–û–ô –õ–û–ì–ò–ö–ò –ó–ê–Ø–í–û–ö –ù–ê –ú–ê–¢–ï–†–ò–ê–õ–´

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-09
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

---

## üéØ –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/dashboard/material-requests`:

#### 1Ô∏è‚É£ **–≠—Ç–∞–ø—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –∑–∞—è–≤–æ–∫**
- –°–æ–±–ª—é–¥–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø–æ —Å–ø–∏—Å–∫—É "–†–æ–ª—å —Å–æ–≥–ª–∞—Å—É—é—â–µ–≥–æ" —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/dashboard/settings/approval-flow`
- –ï—Å–ª–∏ —ç—Ç–∞–ø —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π –∏–∑–º–µ–Ω–∏—Ç—Å—è, –≤—Å–µ –ù–ï —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ –¥–æ–ª–∂–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –Ω–æ–≤—ã–π —ç—Ç–∞–ø —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π
- ‚úÖ **–£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û** –≤ –º–µ—Ç–æ–¥–µ `reconfigure_pending_approvals()` (—Å–º. `/DYNAMIC_APPROVAL_CHAIN_RECONFIGURATION.md`)

#### 2Ô∏è‚É£ **–í–∫–ª–∞–¥–∫–∞ "–ù–∞ –æ–ø–ª–∞—Ç–µ"**
–ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è **–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç—Ç–∞–ø–∞** –∏–∑ "–≠—Ç–∞–ø—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è":
- –ü–æ–∑–∏—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–ù–∞ –æ–ø–ª–∞—Ç–µ"**
- –°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: **"–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ"**
- **–¢–æ–ª—å–∫–æ –°–Ω–∞–±–∂–µ–Ω–µ—Ü** –º–æ–∂–µ—Ç –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É **"–û–ø–ª–∞—á–µ–Ω–æ"**
- –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–û–ø–ª–∞—á–µ–Ω–æ" ‚Üí –ø–æ–∑–∏—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ"**

#### 3Ô∏è‚É£ **–í–∫–ª–∞–¥–∫–∞ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ"**
- –ü–æ–∑–∏—Ü–∏–∏ –æ–∂–∏–¥–∞—é—Ç –¥–æ—Å—Ç–∞–≤–∫—É –Ω–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç
- –°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: **"–ü—Ä–∏–Ω—è—Ç—å"**
- –î–æ—Å—Ç—É–ø –∫ –∫–Ω–æ–ø–∫–µ **"–ü—Ä–∏–Ω—è—Ç—å"** –∏–º–µ—é—Ç —Ä–æ–ª–∏:
  - –ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞ (SITE_MANAGER)
  - –ü—Ä–æ—Ä–∞–± (FOREMAN)
  - –ú–∞—Å—Ç–µ—Ä (MASTER)
  - –ó–∞–≤—Å–∫–ª–∞–¥ –æ–±—ä–µ–∫—Ç–∞ (SITE_WAREHOUSE_MANAGER)
- –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è **"–ü—Ä–∏–Ω—è—Ç—å"** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞:
  - –ï—Å–ª–∏ `actual_quantity >= quantity` ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏"**
  - –ï—Å–ª–∏ `actual_quantity < quantity` ‚Üí –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫–µ **"–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ"**

#### 4Ô∏è‚É£ **–ì—Ä–∞—Ñ–∞ "–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É"**
- –ü—Ä–∞–≤–æ –º–µ–Ω—è—Ç—å –∏–º–µ—é—Ç —Ä–æ–ª–∏:
  - –ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞ (SITE_MANAGER)
  - –ü—Ä–æ—Ä–∞–± (FOREMAN)
  - –ú–∞—Å—Ç–µ—Ä (MASTER)
  - –ó–∞–≤—Å–∫–ª–∞–¥ –æ–±—ä–µ–∫—Ç–∞ (SITE_WAREHOUSE_MANAGER)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥: –µ—Å–ª–∏ `actual_quantity >= quantity` ‚Üí –≤–∫–ª–∞–¥–∫–∞ **"–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏"**

#### 5Ô∏è‚É£ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã**

**–û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≤—Å–µ –≤–∫–ª–∞–¥–∫–∏):**
| –î–∞—Ç–∞ | –ù–æ–º–µ—Ä (–ø/–ø) | –ú–∞—Ç–µ—Ä–∏–∞–ª | –ï–¥. –∏–∑–º. | –ö–æ–ª-–≤–æ –ø–æ –∑–∞—è–≤–∫–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è | –ê–≤—Ç–æ—Ä | –°—Ç–∞—Ç—É—Å | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ | –î–µ–π—Å—Ç–≤–∏—è |

**–í–∫–ª–∞–¥–∫–∞ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ" (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ):**
| –î–∞—Ç–∞ | –ù–æ–º–µ—Ä (–ø/–ø) | –ú–∞—Ç–µ—Ä–∏–∞–ª | –ï–¥. –∏–∑–º. | –ö–æ–ª-–≤–æ –ø–æ –∑–∞—è–≤–∫–µ | **–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É** | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è | –ê–≤—Ç–æ—Ä | –°—Ç–∞—Ç—É—Å | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ | –î–µ–π—Å—Ç–≤–∏—è |

---

## üîç –ê–ù–ê–õ–ò–ó –°–£–©–ï–°–¢–í–£–Æ–©–ï–ô –°–ò–°–¢–ï–ú–´

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (2 —É—Ä–æ–≤–Ω—è):

#### **–£—Ä–æ–≤–µ–Ω—å 1: MaterialRequest (–ó–∞—è–≤–∫–∞)**
```python
MaterialRequest:
  - status: DRAFT | IN_PROGRESS | APPROVED | REJECTED | COMPLETED
  - current_step: ApprovalStep  # –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
  - responsible: User            # –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø
  - approvals: [MaterialRequestApproval]  # –ó–∞–ø–∏—Å–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π
```

**Workflow:**
1. –ê–≤—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫—É ‚Üí —Å—Ç–∞—Ç—É—Å `DRAFT`
2. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ ‚Üí —Å—Ç–∞—Ç—É—Å `IN_PROGRESS`
3. –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `/dashboard/settings/approval-flow`)
4. –í—Å–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–π–¥–µ–Ω—ã ‚Üí —Å—Ç–∞—Ç—É—Å `APPROVED`

#### **–£—Ä–æ–≤–µ–Ω—å 2: MaterialRequestItem (–ü–æ–∑–∏—Ü–∏—è)**
```python
MaterialRequestItem:
  - item_status: ProcessStatus  # 19 —Å—Ç–∞—Ç—É—Å–æ–≤ (—Å–º. –Ω–∏–∂–µ)
  - quantity: Decimal           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ –∑–∞—è–≤–∫–µ
  - actual_quantity: Decimal    # –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–µ–Ω–æ
  - issued_quantity: Decimal    # –í—ã–¥–∞–Ω–æ —Å–æ —Å–∫–ª–∞–¥–∞
```

**–¢–µ–∫—É—â–∏–µ ProcessStatus (19 —Å—Ç–∞—Ç—É—Å–æ–≤):**
```python
DRAFT                           # –ß–µ—Ä–Ω–æ–≤–∏–∫
UNDER_REVIEW                    # –°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞)
WAREHOUSE_CHECK                 # –ó–∞–≤—Å–∫–ª–∞–¥
BACK_TO_SUPPLY                  # –°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ —Å–∫–ª–∞–¥–∞)
ENGINEER_APPROVAL               # –ò–Ω–∂–µ–Ω–µ—Ä –ü–¢–û
BACK_TO_SUPPLY_AFTER_ENGINEER   # –°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –∏–Ω–∂–µ–Ω–µ—Ä–∞)
PROJECT_MANAGER_APPROVAL        # –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
BACK_TO_SUPPLY_AFTER_PM         # –°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ —Ä—É–∫.–ø—Ä–æ–µ–∫—Ç–∞)
DIRECTOR_APPROVAL               # –î–∏—Ä–µ–∫—Ç–æ—Ä
BACK_TO_SUPPLY_AFTER_DIRECTOR   # –°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞)
RETURNED_FOR_REVISION           # –ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ (—É –∞–≤—Ç–æ—Ä–∞)
REWORK                          # –ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ
APPROVED                        # –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ
SENT_TO_SITE                    # –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–±—ä–µ–∫—Ç
WAREHOUSE_SHIPPING              # –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –æ–±—ä–µ–∫—Ç
PAYMENT                         # –ù–∞ –æ–ø–ª–∞—Ç–µ
PAID                            # –û–ø–ª–∞—á–µ–Ω–æ
DELIVERY                        # –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
COMPLETED                       # –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –î–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö workflow

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:
1. **MaterialRequest.status** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ApprovalFlowTemplate (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Ü–µ–ø–æ—á–∫–∞)
2. **MaterialRequestItem.item_status** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã (ProcessStatus)

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ `/dashboard/settings/approval-flow`
- –ù–æ –ø–æ–∑–∏—Ü–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –§–ò–ö–°–ò–†–û–í–ê–ù–ù–£–Æ —Ü–µ–ø–æ—á–∫—É –≤ ProcessStatus
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
  - –ó–∞—è–≤–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å `APPROVED` –Ω–∞ —É—Ä–æ–≤–Ω–µ MaterialRequest
  - –ù–æ –ø–æ–∑–∏—Ü–∏–∏ –≤—Å–µ –µ—â–µ –≤ —Å—Ç–∞—Ç—É—Å–µ `ENGINEER_APPROVAL` –∏–ª–∏ `DIRECTOR_APPROVAL`

---

## üéØ –†–ï–®–ï–ù–ò–ï: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è workflow

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:

**–û—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ ProcessStatus –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.**

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:
1. **–≠—Ç–∞–ø—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è** - —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ ApprovalFlowTemplate (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
2. **–ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è** - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã/–¥–æ—Å—Ç–∞–≤–∫–∏/–ø—Ä–∏–µ–º–∫–∏

### –ù–æ–≤–∞—è —Å—Ö–µ–º–∞ ProcessStatus (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è, 7 —Å—Ç–∞—Ç—É—Å–æ–≤):

```python
class ProcessStatus(models.TextChoices):
    # 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ (—Å–≤—è–∑–∞–Ω–æ —Å MaterialRequest.status)
    DRAFT = 'DRAFT', _('–ß–µ—Ä–Ω–æ–≤–∏–∫')
    IN_APPROVAL = 'IN_APPROVAL', _('–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏')
    RETURNED_FOR_REVISION = 'RETURNED_FOR_REVISION', _('–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ')

    # 2. –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞)
    PAYMENT = 'PAYMENT', _('–ù–∞ –æ–ø–ª–∞—Ç–µ')
    DELIVERY = 'DELIVERY', _('–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ')

    # 3. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    COMPLETED = 'COMPLETED', _('–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ')
    CANCELLED = 'CANCELLED', _('–û—Ç–º–µ–Ω–µ–Ω–æ')
```

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

#### **–≠—Ç–∞–ø 1: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ (—Å–≤—è–∑—å —Å MaterialRequest)**
```
–ê–≤—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫—É
         ‚Üì
MaterialRequest.status = IN_PROGRESS
MaterialRequestItem.item_status = IN_APPROVAL
         ‚Üì
–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –∏–∑ ApprovalFlowTemplate:
  - –†–æ–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
  - –ü–æ—Ä—è–¥–æ–∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –≥–∏–±–∫–∏–π
  - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–ø–æ—á–∫–∏ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
         ‚Üì
–í—Å–µ —ç—Ç–∞–ø—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø—Ä–æ–π–¥–µ–Ω—ã
MaterialRequest.status = APPROVED
         ‚Üì
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π:
MaterialRequestItem.item_status = PAYMENT
```

#### **–≠—Ç–∞–ø 2: –û–ø–ª–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –°–Ω–∞–±–∂–µ–Ω–µ—Ü)**
```
–í–∫–ª–∞–¥–∫–∞ "–ù–∞ –æ–ø–ª–∞—Ç–µ"
–°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: PAYMENT
–ö–Ω–æ–ø–∫–∞: "–û–ø–ª–∞—á–µ–Ω–æ" (–¥–æ—Å—Ç—É–ø: SUPPLY_MANAGER)
         ‚Üì
–°–Ω–∞–±–∂–µ–Ω–µ—Ü –Ω–∞–∂–∏–º–∞–µ—Ç "–û–ø–ª–∞—á–µ–Ω–æ"
         ‚Üì
MaterialRequestItem.item_status = DELIVERY
```

#### **–≠—Ç–∞–ø 3: –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –ø—Ä–∏–µ–º–∫–∞ (–ò–¢–† –Ω–∞ –æ–±—ä–µ–∫—Ç–µ)**
```
–í–∫–ª–∞–¥–∫–∞ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ"
–°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: DELIVERY
–ö–Ω–æ–ø–∫–∞: "–ü—Ä–∏–Ω—è—Ç—å" (–¥–æ—Å—Ç—É–ø: SITE_MANAGER, FOREMAN, MASTER, SITE_WAREHOUSE_MANAGER)
–ü–æ–ª–µ: actual_quantity (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–µ–º–∏ –∂–µ —Ä–æ–ª—è–º–∏)
         ‚Üì
–ò–¢–† —É–∫–∞–∑—ã–≤–∞–µ—Ç actual_quantity
–ò–¢–† –Ω–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–∏–Ω—è—Ç—å"
         ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: actual_quantity >= quantity?
  ‚úÖ –î–ê ‚Üí item_status = COMPLETED (–≤–∫–ª–∞–¥–∫–∞ "–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏")
  ‚ùå –ù–ï–¢ ‚Üí –æ—Å—Ç–∞–µ—Ç—Å—è –≤ DELIVERY (–≤–∫–ª–∞–¥–∫–∞ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ")
```

---

## üìã –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### **–®–ê–ì 1: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Backend**

#### 1.1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å ProcessStatus –≤ models.py

**–§–∞–π–ª:** `/backend/apps/material_requests/models.py`

**–ë—ã–ª–æ (19 —Å—Ç–∞—Ç—É—Å–æ–≤):**
```python
class ProcessStatus(models.TextChoices):
    DRAFT = 'DRAFT', _('–ß–µ—Ä–Ω–æ–≤–∏–∫')
    UNDER_REVIEW = 'UNDER_REVIEW', _('–°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞)')
    WAREHOUSE_CHECK = 'WAREHOUSE_CHECK', _('–ó–∞–≤—Å–∫–ª–∞–¥')
    BACK_TO_SUPPLY = 'BACK_TO_SUPPLY', _('–°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ —Å–∫–ª–∞–¥–∞)')
    ENGINEER_APPROVAL = 'ENGINEER_APPROVAL', _('–ò–Ω–∂–µ–Ω–µ—Ä –ü–¢–û')
    BACK_TO_SUPPLY_AFTER_ENGINEER = 'BACK_TO_SUPPLY_AFTER_ENGINEER', _('–°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –∏–Ω–∂–µ–Ω–µ—Ä–∞)')
    PROJECT_MANAGER_APPROVAL = 'PROJECT_MANAGER_APPROVAL', _('–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞')
    BACK_TO_SUPPLY_AFTER_PM = 'BACK_TO_SUPPLY_AFTER_PM', _('–°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ —Ä—É–∫.–ø—Ä–æ–µ–∫—Ç–∞)')
    DIRECTOR_APPROVAL = 'DIRECTOR_APPROVAL', _('–î–∏—Ä–µ–∫—Ç–æ—Ä')
    BACK_TO_SUPPLY_AFTER_DIRECTOR = 'BACK_TO_SUPPLY_AFTER_DIRECTOR', _('–°–Ω–∞–±–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞)')
    RETURNED_FOR_REVISION = 'RETURNED_FOR_REVISION', _('–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ (—É –∞–≤—Ç–æ—Ä–∞)')
    REWORK = 'REWORK', _('–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ')
    APPROVED = 'APPROVED', _('–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ')
    SENT_TO_SITE = 'SENT_TO_SITE', _('–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–±—ä–µ–∫—Ç')
    WAREHOUSE_SHIPPING = 'WAREHOUSE_SHIPPING', _('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –æ–±—ä–µ–∫—Ç')
    PAYMENT = 'PAYMENT', _('–ù–∞ –æ–ø–ª–∞—Ç–µ')
    PAID = 'PAID', _('–û–ø–ª–∞—á–µ–Ω–æ')
    DELIVERY = 'DELIVERY', _('–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ')
    COMPLETED = 'COMPLETED', _('–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ')
```

**–°—Ç–∞–ª–æ (7 —Å—Ç–∞—Ç—É—Å–æ–≤):**
```python
class ProcessStatus(models.TextChoices):
    DRAFT = 'DRAFT', _('–ß–µ—Ä–Ω–æ–≤–∏–∫')
    IN_APPROVAL = 'IN_APPROVAL', _('–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏')
    RETURNED_FOR_REVISION = 'RETURNED_FOR_REVISION', _('–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ')
    PAYMENT = 'PAYMENT', _('–ù–∞ –æ–ø–ª–∞—Ç–µ')
    DELIVERY = 'DELIVERY', _('–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ')
    COMPLETED = 'COMPLETED', _('–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ')
    CANCELLED = 'CANCELLED', _('–û—Ç–º–µ–Ω–µ–Ω–æ')
```

#### 1.2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

**–§–∞–π–ª:** `/backend/apps/material_requests/migrations/0XXX_simplify_process_status.py`

**–õ–æ–≥–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:**
```python
# –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –Ω–∞ –Ω–æ–≤—ã–µ
STATUS_MAPPING = {
    'DRAFT': 'DRAFT',
    'UNDER_REVIEW': 'IN_APPROVAL',
    'WAREHOUSE_CHECK': 'IN_APPROVAL',
    'BACK_TO_SUPPLY': 'IN_APPROVAL',
    'ENGINEER_APPROVAL': 'IN_APPROVAL',
    'BACK_TO_SUPPLY_AFTER_ENGINEER': 'IN_APPROVAL',
    'PROJECT_MANAGER_APPROVAL': 'IN_APPROVAL',
    'BACK_TO_SUPPLY_AFTER_PM': 'IN_APPROVAL',
    'DIRECTOR_APPROVAL': 'IN_APPROVAL',
    'BACK_TO_SUPPLY_AFTER_DIRECTOR': 'IN_APPROVAL',
    'RETURNED_FOR_REVISION': 'RETURNED_FOR_REVISION',
    'REWORK': 'RETURNED_FOR_REVISION',
    'APPROVED': 'PAYMENT',  # –ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è ‚Üí –Ω–∞ –æ–ø–ª–∞—Ç—É
    'SENT_TO_SITE': 'DELIVERY',
    'WAREHOUSE_SHIPPING': 'DELIVERY',
    'PAYMENT': 'PAYMENT',
    'PAID': 'DELIVERY',  # –û–ø–ª–∞—á–µ–Ω–æ ‚Üí –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–µ
    'DELIVERY': 'DELIVERY',
    'COMPLETED': 'COMPLETED',
}

def migrate_item_statuses(apps, schema_editor):
    MaterialRequestItem = apps.get_model('material_requests', 'MaterialRequestItem')

    for old_status, new_status in STATUS_MAPPING.items():
        MaterialRequestItem.objects.filter(
            item_status=old_status
        ).update(item_status=new_status)
```

#### 1.3. –£–ø—Ä–æ—Å—Ç–∏—Ç—å ITEM_STATUS_TRANSITIONS

**–§–∞–π–ª:** `/backend/apps/material_requests/views.py`

**–ë—ã–ª–æ (—Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å 19 —Å—Ç–∞—Ç—É—Å–∞–º–∏):**
```python
ITEM_STATUS_TRANSITIONS = {
    'SUPPLY_MANAGER': [
        ('UNDER_REVIEW', 'WAREHOUSE_CHECK'),
        ('BACK_TO_SUPPLY', 'ENGINEER_APPROVAL'),
        # ... 10+ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
    ],
    # ... 7 —Ä–æ–ª–µ–π —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
}
```

**–°—Ç–∞–ª–æ (–ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ —Å 7 —Å—Ç–∞—Ç—É—Å–∞–º–∏):**
```python
ITEM_STATUS_TRANSITIONS = {
    # –ê–≤—Ç–æ—Ä (–ü—Ä–æ—Ä–∞–±, –ú–∞—Å—Ç–µ—Ä, –ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞) - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞
    'FOREMAN': [
        ('DRAFT', 'IN_APPROVAL'),                      # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
        ('RETURNED_FOR_REVISION', 'IN_APPROVAL'),      # –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—Å–ª–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏
    ],
    'MASTER': [
        ('DRAFT', 'IN_APPROVAL'),
        ('RETURNED_FOR_REVISION', 'IN_APPROVAL'),
    ],
    'SITE_MANAGER': [
        ('DRAFT', 'IN_APPROVAL'),
        ('RETURNED_FOR_REVISION', 'IN_APPROVAL'),
    ],

    # –°–Ω–∞–±–∂–µ–Ω–µ—Ü - –æ–ø–ª–∞—Ç–∞
    'SUPPLY_MANAGER': [
        ('PAYMENT', 'DELIVERY'),  # –ù–∞–∂–∞—Ç–∏–µ "–û–ø–ª–∞—á–µ–Ω–æ"
    ],

    # –ò–¢–† –Ω–∞ –æ–±—ä–µ–∫—Ç–µ - –ø—Ä–∏–µ–º–∫–∞
    'SITE_MANAGER': [
        ('DELIVERY', 'COMPLETED'),  # –ù–∞–∂–∞—Ç–∏–µ "–ü—Ä–∏–Ω—è—Ç—å" (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π actual_quantity)
    ],
    'FOREMAN': [
        ('DELIVERY', 'COMPLETED'),
    ],
    'MASTER': [
        ('DELIVERY', 'COMPLETED'),
    ],
    'SITE_WAREHOUSE_MANAGER': [
        ('DELIVERY', 'COMPLETED'),
    ],

    # –°—É–ø–µ—Ä–∞–¥–º–∏–Ω - –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
    'SUPERADMIN': [
        ('DRAFT', 'IN_APPROVAL'),
        ('IN_APPROVAL', 'PAYMENT'),
        ('IN_APPROVAL', 'RETURNED_FOR_REVISION'),
        ('RETURNED_FOR_REVISION', 'IN_APPROVAL'),
        ('PAYMENT', 'DELIVERY'),
        ('DELIVERY', 'COMPLETED'),
        ('DELIVERY', 'RETURNED_FOR_REVISION'),
    ],
}
```

#### 1.4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ–∑–∏—Ü–∏–π –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –∑–∞—è–≤–∫–∏

**–§–∞–π–ª:** `/backend/apps/material_requests/models.py`

**–ú–µ—Ç–æ–¥:** `MaterialRequest.move_to_next_step()`

**–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É:**
```python
def move_to_next_step(self):
    """..."""
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ ...

    # –ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø —Å —Å—Ç–∞—Ç—É—Å–æ–º PENDING
    next_approval = self.approvals.filter(
        status='PENDING'
    ).order_by('step__order').first()

    if not next_approval:
        # –í—Å–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–π–¥–µ–Ω—ã - –∑–∞—è–≤–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞
        self.status = self.Status.APPROVED
        self.current_step = None
        self.responsible = None
        self.save(update_fields=['status', 'current_step', 'responsible'])

        # –ù–û–í–û–ï: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π –Ω–∞ –æ–ø–ª–∞—Ç—É
        self.items.filter(
            item_status='IN_APPROVAL'
        ).update(item_status='PAYMENT')

        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        self._log_history(
            user=None,
            old_status='–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏',
            new_status='–ù–∞ –æ–ø–ª–∞—Ç–µ',
            comment='–í—Å–µ —ç—Ç–∞–ø—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø—Ä–æ–π–¥–µ–Ω—ã. –ü–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –æ–ø–ª–∞—Ç—É.'
        )

        # ... –æ—Ç–ø—Ä–∞–≤–∫–∞ email ...
        return

    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ...
```

#### 1.5. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É actual_quantity –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ COMPLETED

**–§–∞–π–ª:** `/backend/apps/material_requests/views.py`

**–ú–µ—Ç–æ–¥:** `change_item_status()`

**–°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞):**
```python
# –õ–û–ì–ò–ö–ê: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ COMPLETED
if new_status == 'COMPLETED':
    actual = item.actual_quantity or 0
    requested = item.quantity

    if actual < requested:
        missing = requested - actual
        return Response({
            'detail': (
                f'–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é: –ø–æ —Ñ–∞–∫—Ç—É –ø–æ–ª—É—á–µ–Ω–æ {actual} {item.unit}, '
                f'–∞ –∑–∞–ø—Ä–æ—à–µ–Ω–æ {requested} {item.unit}. '
                f'–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –µ—â–µ {missing} {item.unit}.'
            ),
            'actual_quantity': float(actual),
            'requested_quantity': float(requested),
            'missing_quantity': float(missing)
        }, status=status.HTTP_400_BAD_REQUEST)
```

‚úÖ **–≠—Ç–∞ –ª–æ–≥–∏–∫–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!**

#### 1.6. –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è actual_quantity

**–§–∞–π–ª:** `/backend/apps/material_requests/views.py`

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥:**
```python
@action(detail=True, methods=['patch'], url_path='update-actual-quantity')
def update_actual_quantity(self, request, pk=None):
    """
    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∑–∏—Ü–∏–∏.
    –î–æ—Å—Ç—É–ø: SITE_MANAGER, FOREMAN, MASTER, SITE_WAREHOUSE_MANAGER

    –ï—Å–ª–∏ actual_quantity >= quantity, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ COMPLETED
    """
    item = self.get_object()
    user = request.user

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
    allowed_roles = ['SITE_MANAGER', 'FOREMAN', 'MASTER', 'SITE_WAREHOUSE_MANAGER', 'SUPERADMIN']
    if user.role not in allowed_roles and not user.is_superuser:
        return Response(
            {'detail': '–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞'},
            status=status.HTTP_403_FORBIDDEN
        )

    # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    actual_quantity = request.data.get('actual_quantity')
    if actual_quantity is None:
        return Response(
            {'detail': '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å actual_quantity'},
            status=status.HTTP_400_BAD_REQUEST
        )

    # –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    old_actual = item.actual_quantity or 0
    item.actual_quantity = actual_quantity
    item.save(update_fields=['actual_quantity'])

    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    MaterialRequestHistory.objects.create(
        request=item.request,
        user=user,
        old_status=f'–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É: {old_actual}',
        new_status=f'–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É: {actual_quantity}',
        comment=f'–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è "{item.material_name}"'
    )

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ COMPLETED
    if item.item_status == 'DELIVERY' and actual_quantity >= item.quantity:
        item.item_status = 'COMPLETED'
        item.save(update_fields=['item_status'])

        MaterialRequestHistory.objects.create(
            request=item.request,
            user=None,
            old_status='–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ',
            new_status='–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ',
            comment=f'–ü–æ–∑–∏—Ü–∏—è "{item.material_name}" –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–ø–æ–ª—É—á–µ–Ω–æ –ø–æ–ª–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)'
        )

    serializer = self.get_serializer(item)
    return Response(serializer.data)
```

---

### **–®–ê–ì 2: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Frontend**

#### 2.1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å—Ç–∞—Ç—É—Å–æ–≤

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
```typescript
const IN_PROGRESS_STATUSES = [
  'UNDER_REVIEW', 'WAREHOUSE_CHECK', 'BACK_TO_SUPPLY',
  'ENGINEER_APPROVAL', 'BACK_TO_SUPPLY_AFTER_ENGINEER',
  'PROJECT_MANAGER_APPROVAL', 'BACK_TO_SUPPLY_AFTER_PM',
  'DIRECTOR_APPROVAL', 'RETURNED_FOR_REVISION'
];

const APPROVED_STATUSES = [
  'BACK_TO_SUPPLY_AFTER_DIRECTOR', 'APPROVED',
  'PAYMENT', 'PAID', 'DELIVERY',
  'SENT_TO_SITE', 'WAREHOUSE_SHIPPING'
];
```

**–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
```typescript
const APPROVAL_STATUSES = ['IN_APPROVAL'];  // –ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏
const PAYMENT_STATUSES = ['PAYMENT'];       // –ù–∞ –æ–ø–ª–∞—Ç–µ
const DELIVERY_STATUSES = ['DELIVERY'];     // –ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ
const COMPLETED_STATUSES = ['COMPLETED'];   // –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ
```

#### 2.2. –û–±–Ω–æ–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–ë—ã–ª–æ:**
```typescript
<Tabs activeKey={activeTab} onChange={setActiveTab} type="card">
  <TabPane tab="–í—Å–µ –∑–∞—è–≤–∫–∏" key="all" />
  <TabPane tab="–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏" key="in_progress" />
  <TabPane tab="–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏" key="approved" />
  <TabPane tab="–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏" key="completed" />
</Tabs>
```

**–°—Ç–∞–ª–æ:**
```typescript
<Tabs activeKey={activeTab} onChange={setActiveTab} type="card">
  <TabPane tab="–í—Å–µ –∑–∞—è–≤–∫–∏" key="all" />
  <TabPane tab="–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏" key="approval" />
  <TabPane tab="–ù–∞ –æ–ø–ª–∞—Ç–µ" key="payment" />
  <TabPane tab="–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ" key="delivery" />
  <TabPane tab="–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏" key="completed" />
</Tabs>
```

#### 2.3. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–ë—ã–ª–æ:**
```typescript
const getFilteredData = (data: FlatMaterialRow[]) => {
  return data.filter(row => {
    if (!row.material) return false;
    const status = row.material.item_status;

    if (activeTab === 'in_progress') {
      return IN_PROGRESS_STATUSES.includes(status);
    }
    if (activeTab === 'approved') {
      return APPROVED_STATUSES.includes(status);
    }
    if (activeTab === 'completed') {
      return status === 'COMPLETED';
    }
    return true;
  });
};
```

**–°—Ç–∞–ª–æ:**
```typescript
const getFilteredData = (data: FlatMaterialRow[]) => {
  return data.filter(row => {
    if (!row.material) return false;
    const status = row.material.item_status;

    if (activeTab === 'approval') {
      return status === 'IN_APPROVAL';
    }
    if (activeTab === 'payment') {
      return status === 'PAYMENT';
    }
    if (activeTab === 'delivery') {
      return status === 'DELIVERY';
    }
    if (activeTab === 'completed') {
      return status === 'COMPLETED';
    }
    return true; // –í–∫–ª–∞–¥–∫–∞ "–í—Å–µ –∑–∞—è–≤–∫–∏"
  });
};
```

#### 2.4. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω—É—é –∫–æ–ª–æ–Ω–∫—É "–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É" –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ":**
```typescript
const columns = [
  {
    title: '–î–∞—Ç–∞',
    dataIndex: 'created_at',
    key: 'created_at',
    render: (date: string) => new Date(date).toLocaleDateString('ru-RU'),
  },
  {
    title: '–ù–æ–º–µ—Ä (–ø/–ø)',
    dataIndex: 'order',
    key: 'order',
  },
  {
    title: '–ú–∞—Ç–µ—Ä–∏–∞–ª',
    dataIndex: 'material_name',
    key: 'material_name',
  },
  {
    title: '–ï–¥. –∏–∑–º.',
    dataIndex: 'unit',
    key: 'unit',
  },
  {
    title: '–ö–æ–ª-–≤–æ –ø–æ –∑–∞—è–≤–∫–µ',
    dataIndex: 'quantity',
    key: 'quantity',
  },

  // –ù–û–í–û–ï: –£—Å–ª–æ–≤–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ "–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É" (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ")
  ...(activeTab === 'delivery' ? [{
    title: '–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É',
    dataIndex: 'actual_quantity',
    key: 'actual_quantity',
    render: (value: number, record: any) => {
      const canEdit = canEditActualQuantity();

      if (canEdit) {
        return (
          <InputNumber
            min={0}
            value={value || 0}
            onChange={(newValue) => handleActualQuantityChange(record.material, newValue)}
            style={{ width: '100%' }}
          />
        );
      }
      return value || 0;
    },
  }] : []),

  {
    title: '–ü—Ä–∏–º–µ—á–∞–Ω–∏—è',
    dataIndex: 'specifications',
    key: 'specifications',
  },
  {
    title: '–ê–≤—Ç–æ—Ä',
    dataIndex: 'author_name',
    key: 'author_name',
  },
  {
    title: '–°—Ç–∞—Ç—É—Å',
    dataIndex: 'status',
    key: 'status',
    render: (status: string) => (
      <Tag color={getStatusColor(status)}>
        {getStatusLabel(status)}
      </Tag>
    ),
  },
  {
    title: '–ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ',
    dataIndex: 'updated_at',
    key: 'updated_at',
    render: (date: string) => new Date(date).toLocaleString('ru-RU'),
  },
  {
    title: '–î–µ–π—Å—Ç–≤–∏—è',
    key: 'actions',
    render: (_, record) => renderActions(record),
  },
];
```

#### 2.5. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å actual_quantity

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ actual_quantity
const canEditActualQuantity = () => {
  if (user?.is_superuser || user?.role === 'SUPERADMIN') {
    return true;
  }
  const allowedRoles = ['SITE_MANAGER', 'FOREMAN', 'MASTER', 'SITE_WAREHOUSE_MANAGER'];
  return allowedRoles.includes(user?.role || '');
};

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è actual_quantity
const handleActualQuantityChange = async (item: any, newValue: number | null) => {
  if (newValue === null || newValue < 0) return;

  try {
    await materialRequestsAPI.updateActualQuantity(item.id, newValue);
    message.success('–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ');

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ COMPLETED
    if (newValue >= item.quantity) {
      message.info('–ü–æ–∑–∏—Ü–∏—è –ø–æ–ª—É—á–∏–ª–∞ –ø–æ–ª–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞ –≤ "–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏"');
    }

    fetchRequests(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
  } catch (error: any) {
    message.error(error.response?.data?.detail || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞');
  }
};
```

#### 2.6. –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–ù–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏:**
```typescript
const renderActions = (record: any) => {
  const itemStatus = record.material?.item_status;
  const isCancelled = record.material?.status === 'CANCELLED';

  if (isCancelled) {
    return <Tag color="red">–û—Ç–º–µ–Ω–µ–Ω–∞</Tag>;
  }

  // –í–∫–ª–∞–¥–∫–∞ "–ù–∞ –æ–ø–ª–∞—Ç–µ" - –∫–Ω–æ–ø–∫–∞ "–û–ø–ª–∞—á–µ–Ω–æ" (—Ç–æ–ª—å–∫–æ –°–Ω–∞–±–∂–µ–Ω–µ—Ü)
  if (itemStatus === 'PAYMENT' && canPayItem()) {
    return (
      <Button
        type="primary"
        size="small"
        onClick={() => handleChangeItemStatus(record.material, 'DELIVERY', '–û–ø–ª–∞—á–µ–Ω–æ')}
        block
      >
        –û–ø–ª–∞—á–µ–Ω–æ
      </Button>
    );
  }

  // –í–∫–ª–∞–¥–∫–∞ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ" - –∫–Ω–æ–ø–∫–∞ "–ü—Ä–∏–Ω—è—Ç—å" (–ò–¢–† –Ω–∞ –æ–±—ä–µ–∫—Ç–µ)
  if (itemStatus === 'DELIVERY' && canAcceptDelivery()) {
    return (
      <Button
        type="primary"
        icon={<CheckOutlined />}
        size="small"
        onClick={() => handleAcceptDelivery(record.material)}
        block
      >
        –ü—Ä–∏–Ω—è—Ç—å
      </Button>
    );
  }

  return null;
};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –æ–ø–ª–∞—Ç—É
const canPayItem = () => {
  if (user?.is_superuser || user?.role === 'SUPERADMIN') {
    return true;
  }
  return user?.role === 'SUPPLY_MANAGER';
};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –ø—Ä–∏–µ–º–∫—É
const canAcceptDelivery = () => {
  if (user?.is_superuser || user?.role === 'SUPERADMIN') {
    return true;
  }
  const allowedRoles = ['SITE_MANAGER', 'FOREMAN', 'MASTER', 'SITE_WAREHOUSE_MANAGER'];
  return allowedRoles.includes(user?.role || '');
};

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∏–µ–º–∫–∏ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π actual_quantity)
const handleAcceptDelivery = async (item: any) => {
  const actual = item.actual_quantity || 0;
  const requested = item.quantity;

  if (actual < requested) {
    Modal.confirm({
      title: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ',
      content: `–ü–æ —Ñ–∞–∫—Ç—É –ø–æ–ª—É—á–µ–Ω–æ ${actual} ${item.unit}, –∞ –∑–∞–ø—Ä–æ—à–µ–Ω–æ ${requested} ${item.unit}. –ù–µ–¥–æ—Å—Ç–∞–µ—Ç ${requested - actual} ${item.unit}. –ü–æ–∑–∏—Ü–∏—è –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ". –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?`,
      onOk: async () => {
        try {
          await materialRequestsAPI.changeItemStatus(item.id, 'COMPLETED');
          message.info('–ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏–µ–º–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –Ω–æ –ø–æ–∑–∏—Ü–∏—è –æ—Å—Ç–∞–ª–∞—Å—å –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–µ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—á–∏');
          fetchRequests();
        } catch (error: any) {
          message.error(error.response?.data?.detail || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–µ–º–∫–µ');
        }
      },
    });
  } else {
    // –ü–æ–ª–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–æ
    try {
      await materialRequestsAPI.changeItemStatus(item.id, 'COMPLETED');
      message.success('–ú–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–∏–Ω—è—Ç –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ "–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏"');
      fetchRequests();
    } catch (error: any) {
      message.error(error.response?.data?.detail || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–µ–º–∫–µ');
    }
  }
};
```

#### 2.7. –û–±–Ω–æ–≤–∏—Ç—å API –º–µ—Ç–æ–¥—ã

**–§–∞–π–ª:** `/frontend/src/api/materialRequests.ts`

**–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥:**
```typescript
export const materialRequestsAPI = {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã ...

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
  updateActualQuantity: async (itemId: number, actualQuantity: number) => {
    const response = await api.patch(
      `/material-requests/items/${itemId}/update-actual-quantity/`,
      { actual_quantity: actualQuantity }
    );
    return response.data;
  },
};
```

#### 2.8. –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤ –Ω–∞ —Ü–≤–µ—Ç–∞

**–§–∞–π–ª:** `/frontend/src/pages/MaterialRequests.tsx`

**–£–ø—Ä–æ—Å—Ç–∏—Ç—å:**
```typescript
const getStatusColor = (status: string): string => {
  const colors: Record<string, string> = {
    DRAFT: 'default',           // –ß–µ—Ä–Ω–æ–≤–∏–∫
    IN_APPROVAL: 'blue',        // –ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏
    RETURNED_FOR_REVISION: 'orange',  // –ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ
    PAYMENT: 'gold',            // –ù–∞ –æ–ø–ª–∞—Ç–µ
    DELIVERY: 'cyan',           // –ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ
    COMPLETED: 'green',         // –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ
    CANCELLED: 'red',           // –û—Ç–º–µ–Ω–µ–Ω–æ
  };
  return colors[status] || 'default';
};

const getStatusLabel = (status: string): string => {
  const labels: Record<string, string> = {
    DRAFT: '–ß–µ—Ä–Ω–æ–≤–∏–∫',
    IN_APPROVAL: '–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏',
    RETURNED_FOR_REVISION: '–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ',
    PAYMENT: '–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ',
    DELIVERY: '–ü—Ä–∏–Ω—è—Ç—å',
    COMPLETED: '–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ',
    CANCELLED: '–û—Ç–º–µ–Ω–µ–Ω–æ',
  };
  return labels[status] || status;
};
```

---

### **–®–ê–ì 3: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

#### 3.1. –û–±–Ω–æ–≤–∏—Ç—å MATERIAL_REQUESTS_APPROVAL_FLOW.md
- –û–ø–∏—Å–∞—Ç—å –Ω–æ–≤—É—é —É–ø—Ä–æ—â–µ–Ω–Ω—É—é —Å—Ö–µ–º—É ProcessStatus
- –î–æ–±–∞–≤–∏—Ç—å —Å—Ö–µ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —É—Ä–æ–≤–Ω–µ–π MaterialRequest –∏ MaterialRequestItem
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã

#### 3.2. –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- –°–æ–∑–¥–∞—Ç—å `/MIGRATION_TO_SIMPLIFIED_WORKFLOW.md`
- –û–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –¥–æ/–ø–æ—Å–ª–µ

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï: –î–û –∏ –ü–û–°–õ–ï

### –î–û (—Ç–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞):

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. ‚ùå –î–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö workflow (MaterialRequest + ProcessStatus)
2. ‚ùå 19 —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–∑–∏—Ü–∏–π (—Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å)
3. ‚ùå –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –≤ ProcessStatus
4. ‚ùå –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏
5. ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
6. ‚ùå –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–ø–æ—á–∫–∏ - –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ ProcessStatus

**Workflow:**
```
DRAFT ‚Üí UNDER_REVIEW ‚Üí WAREHOUSE_CHECK ‚Üí BACK_TO_SUPPLY ‚Üí
ENGINEER_APPROVAL ‚Üí BACK_TO_SUPPLY_AFTER_ENGINEER ‚Üí
PROJECT_MANAGER_APPROVAL ‚Üí BACK_TO_SUPPLY_AFTER_PM ‚Üí
DIRECTOR_APPROVAL ‚Üí BACK_TO_SUPPLY_AFTER_DIRECTOR ‚Üí
APPROVED ‚Üí PAYMENT ‚Üí PAID ‚Üí DELIVERY ‚Üí COMPLETED
```

### –ü–û–°–õ–ï (–Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞):

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
1. ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π workflow —á–µ—Ä–µ–∑ ApprovalFlowTemplate
2. ‚úÖ 7 –ø—Ä–æ—Å—Ç—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–∑–∏—Ü–∏–π
3. ‚úÖ –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ drag-and-drop
4. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π MaterialRequest –∏ MaterialRequestItem
5. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–ø–æ—á–∫–∏
6. ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**Workflow:**
```
DRAFT ‚Üí IN_APPROVAL (–ø—Ä–æ—Ö–æ–¥–∏—Ç —Ü–µ–ø–æ—á–∫—É –∏–∑ ApprovalFlowTemplate) ‚Üí
PAYMENT (–°–Ω–∞–±–∂–µ–Ω–µ—Ü) ‚Üí DELIVERY (–ò–¢–† –Ω–∞ –æ–±—ä–µ–∫—Ç–µ) ‚Üí COMPLETED
```

---

## ‚ö†Ô∏è –†–ò–°–ö–ò –ò –ú–ï–†–´ –ü–†–ï–î–û–°–¢–û–†–û–ñ–ù–û–°–¢–ò

### –†–∏—Å–∫ 1: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
**–ú–µ—Ä—ã:**
- –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ë–î –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
- –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ —Å–ª—É—á–∞–π –æ—Ç–∫–∞—Ç–∞

### –†–∏—Å–∫ 2: –õ–æ–º–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞—è–≤–æ–∫
**–ú–µ—Ä—ã:**
- –ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Å—Ç–∞—Ç—É—Å—ã
- –î–ª—è –∑–∞—è–≤–æ–∫ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –†–∏—Å–∫ 3: –ò–∑–º–µ–Ω–µ–Ω–∏–µ API –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
**–ú–µ—Ä—ã:**
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å API (—Å—Ç–∞—Ä—ã–µ —Å—Ç–∞—Ç—É—Å—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –¥–ª—è —á—Ç–µ–Ω–∏—è)
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥: —Å–Ω–∞—á–∞–ª–∞ backend, –ø–æ—Ç–æ–º frontend
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API

---

## üìã –ß–ï–ö–õ–ò–°–¢ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### Backend:
- [ ] –£–ø—Ä–æ—Å—Ç–∏—Ç—å ProcessStatus (7 —Å—Ç–∞—Ç—É—Å–æ–≤ –≤–º–µ—Å—Ç–æ 19)
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
- [ ] –£–ø—Ä–æ—Å—Ç–∏—Ç—å ITEM_STATUS_TRANSITIONS
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ–∑–∏—Ü–∏–π –≤ PAYMENT –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
- [ ] –°–æ–∑–¥–∞—Ç—å endpoint –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è actual_quantity
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É actual_quantity –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ COMPLETED (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤

### Frontend:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å—Ç–∞—Ç—É—Å–æ–≤
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ (4 –≤–∫–ª–∞–¥–∫–∏: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ, –ù–∞ –æ–ø–ª–∞—Ç–µ, –ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ, –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω—É—é –∫–æ–ª–æ–Ω–∫—É "–ö–æ–ª-–≤–æ –ø–æ —Ñ–∞–∫—Ç—É"
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ actual_quantity
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤ –Ω–∞ —Ü–≤–µ—Ç–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å API –º–µ—Ç–æ–¥ updateActualQuantity

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å MATERIAL_REQUESTS_APPROVAL_FLOW.md
- [ ] –°–æ–∑–¥–∞—Ç—å MIGRATION_TO_SIMPLIFIED_WORKFLOW.md
- [ ] –û–±–Ω–æ–≤–∏—Ç—å CLAUDE.md —Å –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π
- [ ] –°–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- [ ] –¢–µ—Å—Ç: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ –∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
- [ ] –¢–µ—Å—Ç: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [ ] –¢–µ—Å—Ç: –û–ø–ª–∞—Ç–∞ –ø–æ–∑–∏—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –°–Ω–∞–±–∂–µ–Ω–µ—Ü)
- [ ] –¢–µ—Å—Ç: –ü—Ä–∏–µ–º–∫–∞ —Å –ø–æ–ª–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º (–ø–µ—Ä–µ—Ö–æ–¥ –≤ COMPLETED)
- [ ] –¢–µ—Å—Ç: –ü—Ä–∏–µ–º–∫–∞ —Å –Ω–µ–¥–æ—Å—Ç–∞—á–µ–π (–æ—Å—Ç–∞–µ—Ç—Å—è –≤ DELIVERY)
- [ ] –¢–µ—Å—Ç: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ actual_quantity (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥)
- [ ] –¢–µ—Å—Ç: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –∑–∞—è–≤–æ–∫

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –°–•–ï–ú–ê –ù–û–í–û–ô –õ–û–ì–ò–ö–ò

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –°–û–ó–î–ê–ù–ò–ï –ó–ê–Ø–í–ö–ò                               ‚îÇ
‚îÇ  –ê–≤—Ç–æ—Ä (–ü—Ä–æ—Ä–∞–±/–ú–∞—Å—Ç–µ—Ä/–ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞)                        ‚îÇ
‚îÇ  MaterialRequest.status = IN_PROGRESS                            ‚îÇ
‚îÇ  MaterialRequestItem.item_status = IN_APPROVAL                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              –°–û–ì–õ–ê–°–û–í–ê–ù–ò–ï (MaterialRequest level)                ‚îÇ
‚îÇ  –ü—Ä–æ—Ö–æ–¥–∏—Ç —Ü–µ–ø–æ—á–∫—É –∏–∑ /dashboard/settings/approval-flow          ‚îÇ
‚îÇ  –†–æ–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º (drag-and-drop)              ‚îÇ
‚îÇ  –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–ø–æ—á–∫–∏ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞           ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ  –ü—Ä–∏–º–µ—Ä —Ü–µ–ø–æ—á–∫–∏:                                                 ‚îÇ
‚îÇ  1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü                                                    ‚îÇ
‚îÇ  2. –ó–∞–≤—Å–∫–ª–∞–¥                                                     ‚îÇ
‚îÇ  3. –ò–Ω–∂–µ–Ω–µ—Ä –ü–¢–û                                                  ‚îÇ
‚îÇ  4. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞                                         ‚îÇ
‚îÇ  5. –î–∏—Ä–µ–∫—Ç–æ—Ä                                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
              –í–°–ï –≠–¢–ê–ü–´ –ü–†–û–ô–î–ï–ù–´
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MaterialRequest.status = APPROVED                               ‚îÇ
‚îÇ  MaterialRequestItem.item_status = PAYMENT (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  –í–ö–õ–ê–î–ö–ê "–ù–ê –û–ü–õ–ê–¢–ï"                             ‚îÇ
‚îÇ  –°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: PAYMENT ("–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ")                        ‚îÇ
‚îÇ  –ö–Ω–æ–ø–∫–∞: "–û–ø–ª–∞—á–µ–Ω–æ" (–¥–æ—Å—Ç—É–ø: SUPPLY_MANAGER)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
              –°–ù–ê–ë–ñ–ï–ù–ï–¶ –ù–ê–ñ–ò–ú–ê–ï–¢ "–û–ü–õ–ê–ß–ï–ù–û"
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MaterialRequestItem.item_status = DELIVERY                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 –í–ö–õ–ê–î–ö–ê "–ù–ê –î–û–°–¢–ê–í–ö–ï"                            ‚îÇ
‚îÇ  –°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: DELIVERY ("–ü—Ä–∏–Ω—è—Ç—å")                           ‚îÇ
‚îÇ  –ü–æ–ª–µ: actual_quantity (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –ò–¢–†)                      ‚îÇ
‚îÇ  –ö–Ω–æ–ø–∫–∞: "–ü—Ä–∏–Ω—è—Ç—å" (–¥–æ—Å—Ç—É–ø: SITE_MANAGER, FOREMAN, MASTER,      ‚îÇ
‚îÇ                             SITE_WAREHOUSE_MANAGER)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
              –ò–¢–† –£–ö–ê–ó–´–í–ê–ï–¢ actual_quantity
              –ò–¢–† –ù–ê–ñ–ò–ú–ê–ï–¢ "–ü–†–ò–ù–Ø–¢–¨"
                     ‚Üì
              actual_quantity >= quantity?
                     ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚Üì                         ‚Üì
       –î–ê                        –ù–ï–¢
        ‚Üì                         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  COMPLETED     ‚îÇ      ‚îÇ  –û—Å—Ç–∞–µ—Ç—Å—è DELIVERY   ‚îÇ
‚îÇ  (–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ)  ‚îÇ      ‚îÇ  (–ù–∞ –¥–æ—Å—Ç–∞–≤–∫–µ)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-11-09
**–ê–≤—Ç–æ—Ä:** Claude Code
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 4-6 —á–∞—Å–æ–≤
