# üîç –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò –ü–†–û–î–ê–ö–®–ù –°–ï–†–í–ï–†–ê

–í—ã–ø–æ–ª–Ω–∏ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ `vmi2871095` –∏ –æ—Ç–ø—Ä–∞–≤—å –º–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

## 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker compose ps
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**: –í—Å–µ –ª–∏ —Å–µ—Ä–≤–∏—Å—ã –≤ —Å—Ç–∞—Ç—É—Å–µ `Up` (–æ—Å–æ–±–µ–Ω–Ω–æ `checksite_backend`)

---

## 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫)

```bash
docker compose logs backend --tail 50
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ù–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ (ERROR, CRITICAL)
- –ï—Å—Ç—å –ª–∏ —Å—Ç—Ä–æ–∫–∞ "Listening on TCP address 0.0.0.0:8000"

---

## 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Nginx (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å—Ç—Ä–æ–∫)

```bash
docker compose logs nginx --tail 30
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ù–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ 502 Bad Gateway
- –ù–µ—Ç –ª–∏ "Connection refused" –∫ backend

---

## 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –∏–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker compose exec nginx curl -I http://backend:8000/api/
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: `HTTP/1.1 200 OK` –∏–ª–∏ `HTTP/1.1 301`

---

## 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ Nginx —Å–Ω–∞—Ä—É–∂–∏

```bash
curl -I https://stroyka.asia/api/
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: `HTTP/2 200` –∏–ª–∏ `HTTP/2 301`

---

## 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

```bash
grep -A 2 "FORBIDDEN_ROLES" /root/checksite/backend/apps/users/views.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ –±–µ–∑ `'MASTER'`:
```python
FORBIDDEN_ROLES = ['CONTRACTOR', 'SUPERVISOR', 'OBSERVER']
```

---

## 7. –ï—Å–ª–∏ 502 –≤—Å—ë –µ—â—ë –µ—Å—Ç—å - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å

```bash
docker compose exec nginx ping -c 2 backend
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 2 –ø–∞–∫–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, 2 –ø–æ–ª—É—á–µ–Ω–æ

---

## üöÄ –ë–´–°–¢–†–ê–Ø –ö–û–ú–ê–ù–î–ê (–≤—Å—ë –≤ –æ–¥–Ω–æ–º)

–°–∫–æ–ø–∏—Ä—É–π –∏ –≤—ã–ø–æ–ª–Ω–∏ —ç—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
echo "=== 1. –°–¢–ê–¢–£–° –ö–û–ù–¢–ï–ô–ù–ï–†–û–í ==="
docker compose ps

echo -e "\n=== 2. BACKEND LOGS (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å—Ç—Ä–æ–∫) ==="
docker compose logs backend --tail 30

echo -e "\n=== 3. NGINX LOGS (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫) ==="
docker compose logs nginx --tail 20

echo -e "\n=== 4. –ü–†–û–í–ï–†–ö–ê API –ò–ó–ù–£–¢–†–ò ==="
docker compose exec nginx curl -s -I http://backend:8000/api/ | head -5

echo -e "\n=== 5. –ü–†–û–í–ï–†–ö–ê API –°–ù–ê–†–£–ñ–ò ==="
curl -s -I https://stroyka.asia/api/ | head -5

echo -e "\n=== 6. –ü–†–û–í–ï–†–ö–ê –ö–û–î–ê (FORBIDDEN_ROLES) ==="
grep -A 2 "FORBIDDEN_ROLES" /root/checksite/backend/apps/users/views.py

echo -e "\n=== –ì–û–¢–û–í–û! ==="
```

---

–û—Ç–ø—Ä–∞–≤—å –º–Ω–µ –≤—ã–≤–æ–¥ —ç—Ç–∏—Ö –∫–æ–º–∞–Ω–¥, –∏ —è —Ç–æ—á–Ω–æ —Å–∫–∞–∂—É, –≤ —á—ë–º –ø—Ä–æ–±–ª–µ–º–∞! üîß
