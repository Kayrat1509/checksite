# üêõ –ë–ê–ì: –°–Ω–∞–±–∂–µ–Ω–µ—Ü –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏—é –Ω–∞ –æ–ø–ª–∞—Ç—É –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –î–∏—Ä–µ–∫—Ç–æ—Ä–∞

**–î–∞—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:** 2025-11-09
**–°—Ç–∞—Ç—É—Å:** –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π
**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** –°–Ω–∞–±–∂–µ–Ω—Ü—ã (SUPPLY_MANAGER)

---

## üìç –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –°–∏–º–ø—Ç–æ–º—ã:

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –î–∏—Ä–µ–∫—Ç–æ—Ä —Å–æ–≥–ª–∞—Å–æ–≤–∞–ª –∑–∞—è–≤–∫—É –Ω–∞ —É—Ä–æ–≤–Ω–µ –ó–ê–Ø–í–ö–ò (MaterialRequest.status = APPROVED), –ø–æ–∑–∏—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å `BACK_TO_SUPPLY_AFTER_DIRECTOR`.

–°–Ω–∞–±–∂–µ–Ω–µ—Ü –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/dashboard/material-requests` –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏—é –≤ —Å—Ç–∞—Ç—É—Å `PAYMENT` (–ù–∞ –æ–ø–ª–∞—Ç—É), –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –æ—à–∏–±–∫—É:

```
‚ùå "–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏"
```

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

–°–Ω–∞–±–∂–µ–Ω–µ—Ü –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏—é –∏–∑ —Å—Ç–∞—Ç—É—Å–∞ `BACK_TO_SUPPLY_AFTER_DIRECTOR` —Å—Ä–∞–∑—É –≤ —Å—Ç–∞—Ç—É—Å `PAYMENT`.

### –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

–°–Ω–∞–±–∂–µ–Ω–µ—Ü –ù–ï –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞–ø—Ä—è–º—É—é –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤ `ITEM_STATUS_TRANSITIONS`.

---

## üîç –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–∏—á–∏–Ω—ã

### –§–∞–π–ª: `/backend/apps/material_requests/views.py`

#### –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–ª—è SUPPLY_MANAGER (—Å—Ç—Ä–æ–∫–∏ 75-85):

```python
'SUPPLY_MANAGER': [
    ('UNDER_REVIEW', 'WAREHOUSE_CHECK'),
    ('BACK_TO_SUPPLY', 'ENGINEER_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_ENGINEER', 'PROJECT_MANAGER_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_PM', 'DIRECTOR_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'APPROVED'),  # ‚Üê –®–∞–≥ 1: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å
    ('APPROVED', 'PAYMENT'),                         # ‚Üê –®–∞–≥ 2: –¢–æ–ª—å–∫–æ –û–¢–°–Æ–î–ê –º–æ–∂–Ω–æ –Ω–∞ –æ–ø–ª–∞—Ç—É
    ('APPROVED', 'SENT_TO_SITE'),                    # ‚Üê –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –Ω–∞ –æ–±—ä–µ–∫—Ç
    ('PAYMENT', 'PAID'),
    ('PAID', 'DELIVERY'),
],
```

#### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ (—Å—Ç—Ä–æ–∫–∏ 913-931):

```python
user_role = request.user.role  # SUPPLY_MANAGER
current_status = item.item_status  # BACK_TO_SUPPLY_AFTER_DIRECTOR
new_status = request.data.get('new_status')  # PAYMENT

# –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–ª—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
allowed_transitions = ITEM_STATUS_TRANSITIONS.get(user_role, [])

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ (current_status -> new_status) –≤ —Å–ø–∏—Å–∫–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö
if (current_status, new_status) in allowed_transitions:
    allowed = True

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
# ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'PAYMENT') in allowed_transitions?
# –ù–ï–¢! ‚ùå –¢–∞–∫–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ!
```

### –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏–∑–æ—à–ª–æ?

–í `ITEM_STATUS_TRANSITIONS` –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ **–¥–≤—É—Ö—à–∞–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞**:

1. **BACK_TO_SUPPLY_AFTER_DIRECTOR** ‚Üí **APPROVED** (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ")
2. **APPROVED** ‚Üí **PAYMENT** (–æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É)
   **–ò–õ–ò**
   **APPROVED** ‚Üí **SENT_TO_SITE** (–æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç —Å–æ —Å–∫–ª–∞–¥–∞)

–≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã:
- –ü–æ–∑–∏—Ü–∏—è –ø–æ–ª—É—á–∏–ª–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ"
- –°–Ω–∞–±–∂–µ–Ω–µ—Ü –º–æ–≥ –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ: –∑–∞–∫—É–ø–∞—Ç—å (PAYMENT) –∏–ª–∏ –±—Ä–∞—Ç—å —Å–æ —Å–∫–ª–∞–¥–∞ (SENT_TO_SITE)

---

## üéØ –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ (–ë–´–°–¢–†–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï) ‚≠ê

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**

–î–æ–±–∞–≤–∏—Ç—å –ø—Ä—è–º—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –≤ `ITEM_STATUS_TRANSITIONS`:

```python
'SUPPLY_MANAGER': [
    ('UNDER_REVIEW', 'WAREHOUSE_CHECK'),
    ('BACK_TO_SUPPLY', 'ENGINEER_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_ENGINEER', 'PROJECT_MANAGER_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_PM', 'DIRECTOR_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'APPROVED'),
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'PAYMENT'),      # ‚Üê –ù–û–í–´–ô –ü–ï–†–ï–•–û–î!
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'SENT_TO_SITE'), # ‚Üê –ù–û–í–´–ô –ü–ï–†–ï–•–û–î!
    ('APPROVED', 'PAYMENT'),
    ('APPROVED', 'SENT_TO_SITE'),
    ('PAYMENT', 'PAID'),
    ('PAID', 'DELIVERY'),
],
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (1 –º–∏–Ω—É—Ç–∞)
- ‚úÖ –ù–µ –ª–æ–º–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É
- ‚úÖ –°–Ω–∞–±–∂–µ–Ω–µ—Ü –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–ø–ª–∞—Ç—É –∏–ª–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å `APPROVED`
- ‚ö†Ô∏è –í –∏—Å—Ç–æ—Ä–∏–∏ –Ω–µ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ–∑–∏—Ü–∏—è –±—ã–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç**

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ APPROVED (–ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï)

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**

–ü—Ä–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏ –î–∏—Ä–µ–∫—Ç–æ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –∏–∑ `BACK_TO_SUPPLY_AFTER_DIRECTOR` –≤ `APPROVED`.

**–ì–¥–µ –º–µ–Ω—è—Ç—å:**

–í `/backend/apps/material_requests/views.py` –≤ –º–µ—Ç–æ–¥–µ `change_item_status` –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 938 –¥–æ–±–∞–≤–∏—Ç—å:

```python
# –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–∏
item.item_status = new_status

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥: –µ—Å–ª–∏ –î–∏—Ä–µ–∫—Ç–æ—Ä —Å–æ–≥–ª–∞—Å–æ–≤–∞–ª, —Å—Ä–∞–∑—É –≤ APPROVED
if user_role in ['DIRECTOR', 'CHIEF_ENGINEER'] and new_status == 'BACK_TO_SUPPLY_AFTER_DIRECTOR':
    item.item_status = 'APPROVED'

item.save()
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–∑–∏—Ü–∏—è –≤—Å–µ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ `APPROVED`
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –õ–æ–≥–∏–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—é —Å—Ç–∞—Ç—É—Å–∞

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –º–µ–Ω—è—Ç—å UI (—É–±—Ä–∞—Ç—å —Å—Ç–∞—Ç—É—Å BACK_TO_SUPPLY_AFTER_DIRECTOR –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã–±–æ—Ä–∞)
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞—è–≤–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚ö†Ô∏è –û—Ç–ª–æ–∂–∏—Ç—å –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–±—Ä–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å BACK_TO_SUPPLY_AFTER_DIRECTOR (–ö–ê–†–î–ò–ù–ê–õ–¨–ù–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï)

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**

–£–±—Ä–∞—Ç—å —Å—Ç–∞—Ç—É—Å `BACK_TO_SUPPLY_AFTER_DIRECTOR` –ø–æ–ª–Ω–æ—Å—Ç—å—é. –ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –î–∏—Ä–µ–∫—Ç–æ—Ä–∞ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –≤ `APPROVED`.

**–ü–ª—é—Å—ã:**
- ‚úÖ –£–ø—Ä–æ—â–∞–µ—Ç workflow
- ‚úÖ –ú–µ–Ω—å—à–µ —Å—Ç–∞—Ç—É—Å–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ–π –ª–æ–≥–∏–∫–∏
- ‚ùå –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

---

## üõ†Ô∏è –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (–í–∞—Ä–∏–∞–Ω—Ç 1)

### –§–∞–π–ª: `/backend/apps/material_requests/views.py`

**–°—Ç—Ä–æ–∫–∏ 75-85** –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞:

```python
# –°–Ω–∞–±–∂–µ–Ω–µ—Ü
'SUPPLY_MANAGER': [
    ('UNDER_REVIEW', 'WAREHOUSE_CHECK'),
    ('BACK_TO_SUPPLY', 'ENGINEER_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_ENGINEER', 'PROJECT_MANAGER_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_PM', 'DIRECTOR_APPROVAL'),
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'APPROVED'),      # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å—Ç–∞—Ç—É—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'PAYMENT'),       # ‚Üê –ù–û–í–û–ï: –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ–ø–ª–∞—Ç—É
    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'SENT_TO_SITE'),  # ‚Üê –ù–û–í–û–ï: –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ–±—ä–µ–∫—Ç
    ('APPROVED', 'PAYMENT'),                            # –°–Ω–∞–±–∂–µ–Ω–µ—Ü –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É
    ('APPROVED', 'SENT_TO_SITE'),                       # –°–Ω–∞–±–∂–µ–Ω–µ—Ü –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –æ–±—ä–µ–∫—Ç
    ('PAYMENT', 'PAID'),                                # –°–Ω–∞–±–∂–µ–Ω–µ—Ü –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É
    ('PAID', 'DELIVERY'),                               # –°–Ω–∞–±–∂–µ–Ω–µ—Ü –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É
],
```

### –®–∞–≥–∏ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```bash
# 1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª
nano /Users/kairatkhidirboev/Projects/checksite/backend/apps/material_requests/views.py

# 2. –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É 75-85 (SUPPLY_MANAGER –≤ ITEM_STATUS_TRANSITIONS)

# 3. –î–æ–±–∞–≤–∏—Ç—å –¥–≤–µ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏:
#    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'PAYMENT'),
#    ('BACK_TO_SUPPLY_AFTER_DIRECTOR', 'SENT_TO_SITE'),

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
docker compose restart backend

# 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. –ó–∞–π—Ç–∏ –ø–æ–¥ —Å–Ω–∞–±–∂–µ–Ω—Ü–µ–º
2. –û—Ç–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É –≤ —Å—Ç–∞—Ç—É—Å–µ `BACK_TO_SUPPLY_AFTER_DIRECTOR`
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏—é –≤ `PAYMENT`
4. –î–æ–ª–∂–Ω–æ —Å—Ä–∞–±–æ—Ç–∞—Ç—å ‚úÖ

---

## üìä –¢–µ–∫—É—â–∏–π workflow (—Å –±–∞–≥–æ–º):

```
–î–∏—Ä–µ–∫—Ç–æ—Ä —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–µ—Ç
         ‚Üì
BACK_TO_SUPPLY_AFTER_DIRECTOR (–°–Ω–∞–±–∂–µ–Ω–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å)
         ‚Üì
    ‚ùå –û–®–ò–ë–ö–ê: –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ PAYMENT
         ‚Üì
–°–Ω–∞–±–∂–µ–Ω–µ—Ü –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å 2 —à–∞–≥–∞:
    1) BACK_TO_SUPPLY_AFTER_DIRECTOR ‚Üí APPROVED
    2) APPROVED ‚Üí PAYMENT
```

## üìä –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π workflow:

```
–î–∏—Ä–µ–∫—Ç–æ—Ä —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–µ—Ç
         ‚Üì
BACK_TO_SUPPLY_AFTER_DIRECTOR (–°–Ω–∞–±–∂–µ–Ω–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å)
         ‚Üì
    ‚úÖ –°–Ω–∞–±–∂–µ–Ω–µ—Ü –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å:
         ‚Üì                          ‚Üì
      PAYMENT               SENT_TO_SITE
   (–∑–∞–∫—É–ø–∫–∞)              (—Å–æ —Å–∫–ª–∞–¥–∞)
```

---

## üìù –í—ã–≤–æ–¥—ã

1. **–ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞** (ButtonAccess) - —Å–Ω–∞–±–∂–µ–Ω–µ—Ü –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
2. **–ü—Ä–æ–±–ª–µ–º–∞ –≤ workflow-–ª–æ–≥–∏–∫–µ** (ITEM_STATUS_TRANSITIONS) - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥
3. **–ë–∞–≥ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –í–°–ï –∑–∞—è–≤–∫–∏** –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –î–∏—Ä–µ–∫—Ç–æ—Ä–∞
4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–µ** - –¥–æ–±–∞–≤–∏—Ç—å 2 —Å—Ç—Ä–æ–∫–∏ –≤ —Å–ª–æ–≤–∞—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

---

## ‚úÖ –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- [x] –ü—Ä–æ–±–ª–µ–º–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞
- [x] –†–µ—à–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–æ (–í–∞—Ä–∏–∞–Ω—Ç 1)
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ
- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –≤ production

**–î–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2025-11-09
**–§–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω:** `/backend/apps/material_requests/views.py` (—Å—Ç—Ä–æ–∫–∏ 81-82)
**Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω:** ‚úÖ

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-11-09
**–ê–≤—Ç–æ—Ä:** Claude Code
**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `/backend/apps/material_requests/views.py` (—Å—Ç—Ä–æ–∫–∏ 75-85)
- `/backend/apps/material_requests/models.py` (MaterialRequestItem.ProcessStatus)
- `/MATERIAL_REQUESTS_APPROVAL_FLOW.md` (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è workflow)
