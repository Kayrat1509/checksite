# LOCAL vs PRODUCTION: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

## –¢–ê–ë–õ–ò–¶–ê –ù–ï–°–û–û–¢–í–ï–¢–°–¢–í–ò–ô

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | LOCAL (Dev) | PRODUCTION | –ü—Ä–æ–±–ª–µ–º–∞ | –í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ |
|-----------|------------|-----------|----------|------------|
| **company field** | –ï–°–¢–¨ (–º–æ–¥–µ–ª—å + –ë–î) | ‚ùì –ù–ï–ò–ó–í–ï–°–¢–ù–û | –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç field | AttributeError |
| **unique constraint** | –ú–æ–∂–µ—Ç –Ω–µ —Å–æ–∑–¥–∞—Ç—å—Å—è (–º–∏–≥—Ä–∞—Ü–∏—è 0005 –æ—à–∏–±–∫–∞) | –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ù–ï —Å–æ–∑–¥–∞–Ω–∞ | Duplicate request_number | Data corruption |
| **Cache timeout (roles)** | 300 —Å–µ–∫ | 300 —Å–µ–∫ | –°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ |
| **–ò–Ω–¥–µ–∫—Å—ã** | Created (CONCURRENTLY –≤ 0007) | ‚ùì –ù–ï–ò–ó–í–ï–°–¢–ù–û | Query performance | Slow requests |
| **project access check** | –ù–ï–¢ | –ù–ï–¢ | –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö | Security breach |
| **author NULL check** | –ù–ï–¢ | –ù–ï–¢ | AttributeError | Crash –ø—Ä–∏ first_role |

---

## –ö–†–ò–¢–ò–ß–ù–´–ï –†–ê–ó–õ–ò–ß–ò–Ø

### 1. Company Field –≤ –ë–î Production

#### –û–∂–∏–¥–∞–µ–º–æ –≤ models.py:
```python
# –°—Ç—Ä–æ–∫–∞ 84: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≥–æ–≤–æ—Ä–∏—Ç –∫–æ–º–ø–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ project.company
# –°—Ç—Ä–æ–∫–∞ 85-91: –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ project ForeignKey, –Ω–µ—Ç company
```

#### –ù–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏:
- **–ú–∏–≥—Ä–∞—Ü–∏—è 0001_initial.py** —Å–æ–∑–¥–∞–µ—Ç company field (—Å—Ç—Ä–æ–∫–∏ 171-178)
- **views.py** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç company field –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö (73, 558)
- **serializers.py** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç company field (132)

#### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –≤ production?

**–°—Ü–µ–Ω–∞—Ä–∏–π A: –ï—Å–ª–∏ company field –ï–°–¢–¨ –≤ –ë–î**
```
‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ –º–µ–∂–¥—É –º–æ–¥–µ–ª—å—é –∏ –∫–æ–¥–æ–º
```

**–°—Ü–µ–Ω–∞—Ä–∏–π B: –ï—Å–ª–∏ company field –£–î–ê–õ–ï–ù –≤ production**
```
‚ùå views.py line 558: FieldError: Cannot resolve keyword 'company' into field
‚ùå serializers.py line 132: FieldError: Cannot resolve keyword 'company.name' into field
‚ùå API –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω
```

**–°—Ü–µ–Ω–∞—Ä–∏–π C: –ï—Å–ª–∏ company field –ù–ï –±—ã–ª —Å–æ–∑–¥–∞–Ω (–º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã)**
```
‚ùå –¢–µ –∂–µ –æ—à–∏–±–∫–∏ FieldError
‚ùå API –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω
```

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:
–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ production:
```python
python manage.py shell
from apps.material_requests.models import MaterialRequest
print(MaterialRequest._meta.get_field('company'))  # –ï—Å–ª–∏ –µ—Å—Ç—å - —É—Å–ø–µ—Ö
```

---

### 2. Unique Constraint –Ω–∞ request_number

#### –í –º–∏–≥—Ä–∞—Ü–∏–∏ 0005:
```python
table_name = 'material_requests_materialrequest'  # –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï!
```

#### –†–µ–∞–ª—å–Ω–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã:
```python
# models.py line 182:
db_table = 'material_requests'
```

#### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç?

**–í local (dev):**
```
‚ùì Constraint –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
‚ùì –ò–ª–∏ constraint –≤–æ–æ–±—â–µ –Ω–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω (–Ω–æ –º–∏–≥—Ä–∞—Ü–∏—è "—É—Å–ø–µ—à–Ω–∞")
```

**–í production:**
```
‚ùå Constraint –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–û –ù–ï –¥–æ–±–∞–≤–∏—Ç—Å—è (—Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚ùå –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–≤–µ –∑–∞—è–≤–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º request_number
```

#### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ production:
```sql
SELECT constraint_name
FROM information_schema.table_constraints
WHERE table_name='material_requests'
AND constraint_name='unique_request_number_per_company';
-- –ï—Å–ª–∏ NULL - constraint –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

---

### 3. –ú–∏–≥—Ä–∞—Ü–∏—è 0007 - CONCURRENTLY –∏–Ω–¥–µ–∫—Å—ã

#### –í local:
```
‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ CONCURRENTLY
‚úÖ –¢–∞–±–ª–∏—Ü–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
```

#### –í production (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç PostgreSQL –≤–µ—Ä—Å–∏–∏):
```
‚ö†Ô∏è CONCURRENTLY —Ç—Ä–µ–±—É–µ—Ç PostgreSQL 9.2+
‚ö†Ô∏è –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è —Å—Ç–∞—Ä—à–µ - –æ—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
‚ö†Ô∏è –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã - queries –º–µ–¥–ª–µ–Ω–Ω—ã–µ
```

#### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
```sql
SELECT indexname FROM pg_indexes
WHERE tablename='material_requests' AND indexname LIKE 'idx_%';
```

---

### 4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–æ–ª–µ–π

#### Local (dev):
```
‚úÖ Cache timeout: 300 —Å–µ–∫
‚úÖ Redis –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π cache)
```

#### Production:
```
‚ö†Ô∏è Cache timeout: 300 —Å–µ–∫ (–°–õ–ò–®–ö–û–ú –î–û–õ–ì–û!)
‚ö†Ô∏è –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π memory cache
‚ö†Ô∏è –ù–µ—Ç –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫—ç—à–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–æ–±–ª–µ–º—ã:
```
1. –í 10:00 –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ä–æ–ª—å—é ENGINEER
2. –í 10:01 –∫—Ç–æ-—Ç–æ –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
3. Cache –µ—â–µ –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ ENGINEER –Ω–µ—Ç –≤ –∫–æ–º–ø–∞–Ω–∏–∏ (–∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω –≤ 10:00)
4. –ó–∞—è–≤–∫–∞ –∑–∞–≤–∏—Å–Ω–µ—Ç –Ω–∞ IN_APPROVAL —Å —Ä–æ–ª—å—é ENGINEER, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç (–ø–æ –∫—ç—à—É)
5. –í 10:05 (—á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç) –∫—ç—à –æ–±–Ω–æ–≤–∏—Ç—Å—è –∏ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç
```

---

### 5. Project Access Check

#### Local (dev):
```
‚ùå –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø—Ä–æ–µ–∫—Ç—É
‚ùå –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —É—è–∑–≤–∏–º–æ
```

#### Production:
```
‚ùå –¢–ê –ñ–ï –ü–†–û–ë–õ–ï–ú–ê
‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ A –º–æ–∂–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –∑–∞—è–≤–∫—É –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ B
‚ö†Ô∏è –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
```

#### –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:
```
1. –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞—è–≤–∫–∞ –≤ –ü—Ä–æ–µ–∫—Ç–µ B (–∑–∞–∫—Ä—ã—Ç—ã–π –ø—Ä–æ–µ–∫—Ç –∫–æ–º–ø–∞–Ω–∏–∏)
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ A (ENGINEER) —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–µ—Ç –∑–∞—è–≤–∫—É –ü—Ä–æ–µ–∫—Ç–∞ B
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ü—Ä–æ–µ–∫—Ç–µ B
4. GDPR –Ω–∞—Ä—É—à–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —Ä–∞–∑–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º
```

---

### 6. Race Condition –≤ –Ω–æ–º–µ—Ä–µ –∑–∞—è–≤–∫–∏

#### Local (dev):
```
‚ö†Ô∏è –†–µ–¥–∫–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç (–Ω—É–∂–Ω–∞ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∞—è timing)
‚ö†Ô∏è select_for_update() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω–æ–π
```

#### Production (–≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞):
```
‚ùå –ú–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —á–∞—â–µ
‚ùå –ï—Å–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞—è–≤–æ–∫ - –º–æ–∂–µ—Ç –±—ã—Ç—å race condition
‚ùå –û—Å–æ–±–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞—è–≤–∫–µ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ (–Ω–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö records –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π:
```
–í–†–ï–ú–Ø  | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | SQL Query
-------|--------------|------------------
10:00:00.000 | –Æ–∑–µ—Ä 1 | SELECT MAX(request_number) FROM material_requests WHERE company_id=1
10:00:00.001 | –Æ–∑–µ—Ä 2 | SELECT MAX(request_number) FROM material_requests WHERE company_id=1
10:00:00.100 | –Æ–∑–µ—Ä 1 | INSERT INTO material_requests VALUES (..., '14112025-1')
10:00:00.101 | –Æ–∑–µ—Ä 2 | INSERT INTO material_requests VALUES (..., '14112025-1')  -- DUPLICATE!
```

---

### 7. Author NULL Check

#### Local (dev):
```
‚ùì –†–µ–¥–∫–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç (–æ–±—ã—á–Ω–æ –µ—Å—Ç—å –∞–≤—Ç–æ—Ä)
‚ùì –ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–¥ —Å author=NULL - AttributeError
```

#### Production:
```
‚ö†Ô∏è –ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ author=NULL (soft delete, cascade issue)
‚ö†Ô∏è get_first_approval_role() —É–ø–∞–¥–µ—Ç –Ω–∞ AttributeError
‚ö†Ô∏è –ó–∞—è–≤–∫–∞ –Ω–µ —Å–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
```

---

## –†–ê–ó–õ–ò–ß–ò–Ø –í –§–£–ù–ö–¶–ò–û–ù–ò–†–û–í–ê–ù–ò–ò

### Models –∏ –ú–∏–≥—Ä–∞—Ü–∏–∏

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | Local | Production |
|----------|-------|-----------|
| Company field —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | ‚úÖ YES (0001) | ‚ùì UNKNOWN |
| Constraint –¥–æ–±–∞–≤–ª–µ–Ω | ‚ùì MAYBE (–æ—à–∏–±–∫–∞ –≤ 0005) | ‚ùå NO (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã) |
| –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã | ‚úÖ YES (0007) | ‚ùì MAYBE (–Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞) |
| Status field –≤ items | ‚úÖ YES (0006) | ‚úÖ YES (0006) |

### Views –∏ API

| Endpoint | Local | Production |
|----------|-------|-----------|
| /api/material-requests/ | ‚úÖ Works | ‚ö†Ô∏è MAYBE (company field) |
| /approve | ‚ö†Ô∏è No project check | ‚ö†Ô∏è No project check |
| /statistics | ‚ö†Ô∏è Incomplete filter | ‚ö†Ô∏è Incomplete filter |
| Cache timeout | ‚ö†Ô∏è 300 sec | ‚ö†Ô∏è 300 sec |

### Database Constraints

| Constraint | Local | Production |
|-----------|-------|-----------|
| UNIQUE(company_id, request_number) | ‚ùå NOT CREATED | ‚ùå NOT CREATED |
| FOREIGN KEY author | ‚úÖ YES | ‚úÖ YES |
| FOREIGN KEY project | ‚úÖ YES | ‚úÖ YES |

---

## CHECKLIST: –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥ Production Deploy

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ company field –≤ –ë–î production
  ```sql
  SELECT column_name FROM information_schema.columns
  WHERE table_name='material_requests' AND column_name='company_id';
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–æ–∑–¥–∞–Ω –ª–∏ unique constraint
  ```sql
  SELECT constraint_name FROM information_schema.table_constraints
  WHERE table_name='material_requests' 
  AND constraint_name='unique_request_number_per_company';
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–æ–∑–¥–∞–Ω—ã –ª–∏ –∏–Ω–¥–µ–∫—Å—ã
  ```sql
  SELECT indexname FROM pg_indexes
  WHERE tablename='material_requests' AND indexname LIKE 'idx_%';
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é PostgreSQL
  ```sql
  SELECT version();  -- –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å >= 9.2 –¥–ª—è CONCURRENTLY
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ Redis
  ```bash
  redis-cli ping  # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å PONG
  ```

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

- [ ] –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–º–µ—Ä
  ```
  GET /api/material-requests/?tab=draft
  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞—è–≤–∫–∞ —Å –Ω–æ–º–µ—Ä–æ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î–ú–ú–ì–ì–ì–ì-‚Ññ
  ```

- [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å first_role
  ```
  POST /api/material-requests/{id}/submit/
  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å current_approval_role
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
  ```
  # –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å 10+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
  ab -n 10 -c 10 /api/material-requests/
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  ```
  GET /api/material-requests/statistics/
  # –°—á–µ—Ç—á–∏–∫–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å filtered list
  ```

---

## RISK LEVEL –î–õ–Ø PRODUCTION

### üî¥ CRITICAL (Deploy-blocking):
1. Company field –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –≤–µ—Å—å API —Å–ª–æ–º–∞–Ω
2. Project access check –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí security breach

### üü† HIGH (Should fix before deploy):
1. Unique constraint –Ω–µ —Å–æ–∑–¥–∞–Ω ‚Üí data corruption
2. Race condition –≤ –Ω–æ–º–µ—Ä–µ ‚Üí duplicate –Ω–æ–º–µ—Ä–∞
3. Author NULL check –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí crash –ø—Ä–∏ first_role

### üü° MEDIUM (Fix in next sprint):
1. Cache timeout —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–π ‚Üí delayed updates
2. Statistics mismatch ‚Üí UI confusing

### üü¢ LOW (Nice to have):
1. ApprovalStep comment not saved ‚Üí feature incomplete
2. –î–æ–±–∞–≤–∏—Ç—å logging ‚Üí harder to debug

---

## –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

‚ö†Ô∏è **–ù–ï –î–ï–ü–õ–û–ò–¢–¨ –í PRODUCTION –ë–ï–ó:**

1. –ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è company field
2. –ü—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ constraint
3. –î–æ–±–∞–≤–ª–µ–Ω–∏—è project access check –≤ approve/reject
4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ_role fallback

**–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2-3 —á–∞—Å–∞
**–í—Ä–µ–º—è –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** 1-2 —á–∞—Å–∞
**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 3-5 —á–∞—Å–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** CRITICAL - –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç production deploy
