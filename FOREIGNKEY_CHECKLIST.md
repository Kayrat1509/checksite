# Контрольный список исправления ForeignKey

## Обнаруженные проблемы

- [ ] **Task.created_by** (строка 55-61)
  - [ ] Изменить `on_delete=models.CASCADE` на `on_delete=models.SET_NULL`
  - [ ] Добавить `null=True` параметр
  
- [ ] **Task.assigned_to_user** (строка 63-71)
  - [ ] Изменить `on_delete=models.CASCADE` на `on_delete=models.SET_NULL`
  
- [ ] **Task.assigned_to_contractor** (строка 73-82)
  - [ ] Изменить `on_delete=models.CASCADE` на `on_delete=models.SET_NULL`
  
- [ ] **TenderBid.participant** (строка 142-147)
  - [ ] Изменить `on_delete=models.CASCADE` на `on_delete=models.SET_NULL`
  - [ ] Добавить `null=True` параметр

## Шаги исправления

### Файл 1: backend/apps/tasks/models.py

1. [ ] Открыть файл
2. [ ] Строка 55-61: Изменить `created_by` ForeignKey
3. [ ] Строка 63-71: Изменить `assigned_to_user` ForeignKey
4. [ ] Строка 73-82: Изменить `assigned_to_contractor` ForeignKey
5. [ ] Сохранить файл

### Файл 2: backend/apps/tenders/models.py

1. [ ] Открыть файл
2. [ ] Строка 142-147: Изменить `participant` ForeignKey
3. [ ] Сохранить файл

## Создание миграций

- [ ] Выполнить `python manage.py makemigrations tasks`
- [ ] Выполнить `python manage.py makemigrations tenders`
- [ ] Проверить созданные миграции на корректность
- [ ] Выполнить `python manage.py migrate`

## Тестирование

### Тест 1: Удаление создателя задачи
- [ ] Создать задачу от пользователя A
- [ ] Удалить пользователя A
- [ ] Проверить что задача осталась в БД
- [ ] Проверить что created_by = NULL

### Тест 2: Удаление назначенного сотрудника
- [ ] Создать задачу назначенную на пользователя B
- [ ] Удалить пользователя B
- [ ] Проверить что задача осталась в БД
- [ ] Проверить что assigned_to_user = NULL

### Тест 3: Удаление подрядчика
- [ ] Создать задачу назначенную на подрядчика C
- [ ] Удалить подрядчика C
- [ ] Проверить что задача осталась в БД
- [ ] Проверить что assigned_to_contractor = NULL

### Тест 4: Удаление участника тендера
- [ ] Создать заявку на тендер от пользователя D
- [ ] Удалить пользователя D
- [ ] Проверить что заявка осталась в БД
- [ ] Проверить что participant = NULL

## Проверка в админ-панели

- [ ] Открить http://localhost:8001/admin/tasks/task/
- [ ] Проверить что удаленные задачи видны с NULL в поле создателя
- [ ] Открить http://localhost:8001/admin/tenders/tenderbid/
- [ ] Проверить что удаленные заявки видны с NULL в поле участника

## Документация

- [ ] Обновить документацию проекта если нужно
- [ ] Закоммитить изменения с понятным сообщением
- [ ] Отправить PR если нужно

## Финальная проверка

- [ ] Все миграции применены
- [ ] Не было ошибок при миграции
- [ ] Все тесты прошли
- [ ] Данные в БД не потеряны
- [ ] Система работает стабильно

---

**Статус**: В процессе ⏳
**Дата начала**: 2025-11-06
**Дата завершения**: -
**Исполнитель**: -
