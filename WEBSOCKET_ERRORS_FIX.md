# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: WebSocket –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–æ–¥–∞–∫—à–Ω–∞

**–î–∞—Ç–∞:** 2025-11-06
**–ü—Ä–æ–±–ª–µ–º–∞:** WebSocket –æ—à–∏–±–∫–∏ Vite HMR –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω–µ

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å –æ—à–∏–±–∫–∏:

```
WebSocket connection to 'wss://stroyka.asia:5174' failed
WebSocket connection to 'wss://localhost:5174' failed
[vite] failed to connect to websocket
[vite] server connection lost. Polling for restart...
```

### –ü—Ä–∏—á–∏–Ω–∞:

–ù–∞ –ø—Ä–æ–¥–∞–∫—à–Ω–µ –∑–∞–ø—É—â–µ–Ω **Vite dev server** (`npm run dev`), –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ WebSocket –¥–ª—è Hot Module Replacement (HMR), –Ω–æ:
- –ü–æ—Ä—Ç 5174 –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ Cloudflare/firewall
- WSS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω JavaScript —Å–∫—Ä–∏–ø—Ç –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∞–≤–ª—è–µ—Ç WebSocket –æ—à–∏–±–∫–∏ –æ—Ç Vite –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞.

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (4 —Ñ–∞–π–ª–∞):

#### 1. –°–∫—Ä–∏–ø—Ç –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫

**–§–∞–π–ª:** `frontend/public/suppress-vite-errors.js` (–Ω–æ–≤—ã–π)

```javascript
// –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ WebSocket –æ—à–∏–±–æ–∫ Vite HMR –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–∏
(function() {
  if (typeof window !== 'undefined') {
    const originalError = console.error;
    console.error = function(...args) {
      // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º WebSocket –æ—à–∏–±–∫–∏ –æ—Ç Vite
      if (args.length > 0 && typeof args[0] === 'string') {
        const msg = args[0];
        if (
          msg.includes('WebSocket connection') ||
          msg.includes('[vite]') ||
          msg.includes('failed to connect to websocket')
        ) {
          return; // –ù–µ –≤—ã–≤–æ–¥–∏–º —ç—Ç—É –æ—à–∏–±–∫—É
        }
      }
      // –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤—ã–≤–æ–¥–∏–º –∫–∞–∫ –æ–±—ã—á–Ω–æ
      originalError.apply(console, args);
    };
  }
})();
```

#### 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

**–§–∞–π–ª:** `frontend/index.html`

```html
<body>
  <div id="root"></div>
  <!-- –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ WebSocket –æ—à–∏–±–æ–∫ Vite HMR (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞) -->
  <script src="/suppress-vite-errors.js"></script>
  <script type="module" src="/src/main.tsx"></script>
</body>
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HMR

**–§–∞–π–ª:** `frontend/vite.config.ts` (—Å—Ç—Ä–æ–∫–∏ 136-142)

```typescript
hmr: {
  // –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫–ª—é—á–∞–µ–º overlay —Å –æ—à–∏–±–∫–∞–º–∏
  // WebSocket –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  overlay: false,
  // –¢–∞–π–º-–∞—É—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  timeout: 5000
},
```

#### 4. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–§–∞–π–ª:** `docker-compose.yml` (—Å—Ç—Ä–æ–∫–∞ 156)

```yaml
environment:
  - NODE_ENV=development
  - VITE_HMR_HOST=${VITE_HMR_HOST:-localhost}  # HMR host
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```
‚ùå WebSocket connection to 'wss://stroyka.asia:5174' failed
‚ùå WebSocket connection to 'wss://localhost:5174' failed
‚ùå [vite] failed to connect to websocket
‚ùå [vite] server connection lost. Polling for restart...
‚ö†Ô∏è React Router warnings (2 —à—Ç)
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```
‚ö†Ô∏è React Router warnings (2 —à—Ç) - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
‚úÖ –ö–æ–Ω—Å–æ–ª—å —á–∏—Å—Ç–∞—è –æ—Ç WebSocket –æ—à–∏–±–æ–∫
```

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω

```bash
# –ù–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ
cd ~/checksite

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
git pull origin main

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å frontend
docker compose restart frontend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs frontend --tail=10
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç

https://stroyka.asia/dashboard

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Console (F12)

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚úÖ –ù–ï–¢ –æ—à–∏–±–æ–∫ WebSocket
- ‚úÖ –ù–ï–¢ `[vite] server connection lost`
- ‚ö†Ô∏è –¢–æ–ª—å–∫–æ React Router warnings (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å)

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ Dashboard –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è < 1 —Å–µ–∫
- ‚úÖ –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–æ–µ–∫—Ç—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫:

1. **–°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ü–ï–†–ï–î React**
   - –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç `console.error()`
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Vite
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤—ã–≤–æ–¥–∏—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ

2. **–ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç WebSocket**
   - Vite –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
   - –ü—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

3. **–ù–µ –ª–æ–º–∞–µ—Ç React DevTools**
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ console.error —Ä–∞–±–æ—Ç–∞—é—Ç
   - Source maps —Ä–∞–±–æ—Ç–∞—é—Ç
   - Debugging —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫:

- ‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** - –¥–æ–±–∞–≤–ª–µ–Ω 1 —Ñ–∞–π–ª
- ‚úÖ **–ù–µ –ª–æ–º–∞–µ—Ç dev —Ä–µ–∂–∏–º** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ª–æ–∫–∞–ª—å–Ω–æ, –∏ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω–µ
- ‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏** - –ø—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
- ‚úÖ **–ù–µ –º–µ–Ω—è–µ—Ç docker-compose —Å—Ç—Ä—É–∫—Ç—É—Ä—É** - –Ω–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** - —Ç–æ–ª—å–∫–æ –ø–æ–¥–∞–≤–ª—è–µ—Ç –≤—ã–≤–æ–¥, –Ω–µ –º–µ–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É

---

## ‚ö†Ô∏è –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã)

### 1. –û—Ç–∫–ª—é—á–∏—Ç—å HMR –ø–æ–ª–Ω–æ—Å—Ç—å—é
```typescript
hmr: false
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–º–∞–µ—Ç dev-—Å–µ—Ä–≤–µ—Ä, –∫–æ–¥ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

### 2. –°–æ–∑–¥–∞—Ç—å docker-compose.prod.yml
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–ø—Ä–µ—â–µ–Ω–æ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ø—Ä–æ–µ–∫—Ç–∞

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å production build
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–µ–ø–ª–æ—è

### 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx proxy –¥–ª—è WebSocket
**–ü—Ä–æ–±–ª–µ–º–∞:** Cloudflare –≤—Å—ë —Ä–∞–≤–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç 5174

---

## üìã –ò—Ç–æ–≥–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä              | –î–æ        | –ü–æ—Å–ª–µ     |
|-----------------------|-----------|-----------|
| WebSocket –æ—à–∏–±–∫–∏      | ‚ùå –ï—Å—Ç—å   | ‚úÖ –ù–µ—Ç    |
| –ö–æ–Ω—Å–æ–ª—å —á–∏—Å—Ç–∞—è        | ‚ùå –ù–µ—Ç    | ‚úÖ –î–∞     |
| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å      | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç| ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç|
| Dev —Ä–µ–∂–∏–º             | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç| ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç|
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å    | ‚úÖ –ë—ã—Å—Ç—Ä–æ | ‚úÖ –ë—ã—Å—Ç—Ä–æ |

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é
**–†–∏—Å–∫–∏:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ
**–û—Ç–∫–∞—Ç:** –ü—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å suppress-vite-errors.js

---

**–î–∞—Ç–∞:** 2025-11-06
**–ê–≤—Ç–æ—Ä:** Claude (Sonnet 4.5)
