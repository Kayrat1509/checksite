# ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞—è–≤–æ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

**–î–∞—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** 2025-11-09
**–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:

–ï—Å–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–∑–º–µ–Ω—è–ª –ø–æ—Ä—è–¥–æ–∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/dashboard/settings/approval-flow`, –∞–∫—Ç–∏–≤–∏—Ä—É—è –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É, –≤—Å–µ –∑–∞—è–≤–∫–∏, –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è, **–ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ —Å—Ç–∞—Ä–æ–π —Ü–µ–ø–æ—á–∫–µ**.

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. ‚ùå –ó–∞—è–≤–∫–∏ "–∑–∞—Å—Ç—Ä–µ–≤–∞–ª–∏" –Ω–∞ —ç—Ç–∞–ø–∞—Ö, –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ –Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–µ
2. ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
3. ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞–ª–∏, –ø–æ—á–µ–º—É –∑–∞—è–≤–∫–∞ –Ω–µ –¥–≤–∏–∂–µ—Ç—Å—è –¥–∞–ª—å—à–µ
4. ‚ùå –¢—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞—è–≤–∫–∏

---

## üéØ –†–µ—à–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏ —á–µ—Ä–µ–∑ `/dashboard/settings/approval-flow`
2. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –∑–∞—è–≤–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `IN_PROGRESS` –∏–ª–∏ `DRAFT`
3. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π —ç—Ç–∞–ø (—Ä–æ–ª—å)
4. –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –æ–∂–∏–¥–∞—é—â–∏–µ (`PENDING`) —ç—Ç–∞–ø—ã –∏–∑ —Å—Ç–∞—Ä–æ–π —Ü–µ–ø–æ—á–∫–∏
5. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ —ç—Ç–∞–ø—ã –∏–∑ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏, –Ω–∞—á–∏–Ω–∞—è –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–≥–æ —ç—Ç–∞–ø–∞
6. –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –∑–∞—è–≤–∫—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (–∏–ª–∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç, –µ—Å–ª–∏ —ç—Ç–∞–ø–æ–≤ –±–æ–ª—å—à–µ –Ω–µ—Ç)
7. –õ–æ–≥–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é –∑–∞—è–≤–∫–∏

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### 1. –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `reconfigure_pending_approvals()`

**–§–∞–π–ª:** `/backend/apps/material_requests/models.py` (—Å—Ç—Ä–æ–∫–∏ 444-552)

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
def reconfigure_pending_approvals(self, new_flow_template):
    """
    –ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∑–∞—è–≤–∫—É –Ω–∞ –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.

    Args:
        new_flow_template: –ù–æ–≤—ã–π —à–∞–±–ª–æ–Ω —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (ApprovalFlowTemplate)
    """
```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**

```python
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏
if self.status not in [self.Status.IN_PROGRESS, self.Status.DRAFT]:
    return  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞—è–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã/–æ—Ç–∫–ª–æ–Ω–µ–Ω—ã/–∑–∞–≤–µ—Ä—à–µ–Ω—ã

# 2. –ü–æ–∏—Å–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–≥–æ —ç—Ç–∞–ø–∞
last_approved = self.approvals.filter(
    status='APPROVED'
).order_by('-step__order').first()

# 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å—É—é—â–µ–≥–æ
if last_approved:
    last_approved_role = last_approved.step.role
    # –ù–∞—Ö–æ–¥–∏–º —ç—Ç—É —Ä–æ–ª—å –≤ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–µ
    for idx, step in enumerate(new_steps):
        if step.role == last_approved_role:
            start_from_order = idx + 1  # –ù–∞—á–∏–Ω–∞–µ–º —Å–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç—Ç–∞–ø–∞
            break
else:
    start_from_order = 0  # –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–≥–æ —ç—Ç–∞–ø–∞

# 4. –£–¥–∞–ª–µ–Ω–∏–µ –æ–∂–∏–¥–∞—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤
deleted_count = self.approvals.filter(status='PENDING').delete()[0]

# 5. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç—Ç–∞–ø–æ–≤
for step in new_steps[start_from_order:]:
    MaterialRequestApproval.objects.create(
        material_request=self,
        step=step,
        status='PENDING'
    )

# 6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
self._log_history(
    user=None,
    old_status='–¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è',
    new_status='–û–±–Ω–æ–≤–ª–µ–Ω–∞',
    comment=f'–¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ "{new_flow_template.name}". ...'
)

# 7. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø
self.move_to_next_step()
```

---

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ endpoint `activate()`

**–§–∞–π–ª:** `/backend/apps/material_requests/approval_views.py` (—Å—Ç—Ä–æ–∫–∏ 85-135)

**–î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
@action(detail=True, methods=['post'], url_path='activate')
def activate(self, request, pk=None):
    template = self.get_object()

    # –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã
    ApprovalFlowTemplate.objects.filter(...).update(is_active=False)

    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–±–ª–æ–Ω
    template.is_active = True
    template.save()

    return Response(serializer.data)
```

**–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
@action(detail=True, methods=['post'], url_path='activate')
def activate(self, request, pk=None):
    from .models import MaterialRequest
    import logging

    logger = logging.getLogger(__name__)
    template = self.get_object()

    # –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã
    ApprovalFlowTemplate.objects.filter(
        company=template.company,
        is_active=True
    ).exclude(pk=template.pk).update(is_active=False)

    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–±–ª–æ–Ω
    template.is_active = True
    template.save()

    # –ù–û–í–û–ï: –ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤—Å–µ –∑–∞—è–≤–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
    pending_requests = MaterialRequest.objects.filter(
        project__company=template.company,
        status__in=['IN_PROGRESS', 'DRAFT']
    )

    reconfigured_count = 0
    for material_request in pending_requests:
        try:
            material_request.reconfigure_pending_approvals(template)
            reconfigured_count += 1
            logger.info(
                f'–ó–∞—è–≤–∫–∞ {material_request.request_number} —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ '
                f'–Ω–∞ –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É "{template.name}"'
            )
        except Exception as e:
            logger.error(
                f'–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∑–∞—è–≤–∫–∏ {material_request.request_number}: {str(e)}'
            )

    logger.info(
        f'–¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è "{template.name}" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. '
        f'–ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∑–∞—è–≤–æ–∫: {reconfigured_count} –∏–∑ {pending_requests.count()}'
    )

    return Response(serializer.data)
```

---

## üìä –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç—Ç–∞–ø–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É —Ü–µ–ø–æ—á–∫–∏

**–°—Ç–∞—Ä–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
3. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –ó–∞–≤—Å–∫–ª–∞–¥          ‚Üê –ù–û–í–´–ô –≠–¢–ê–ü
3. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
4. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ó–∞—è–≤–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ (—ç—Ç–∞–ø 2)

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚è≥ **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: –ó–∞–≤—Å–∫–ª–∞–¥** (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 2)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 3)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –î–∏—Ä–µ–∫—Ç–æ—Ä (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 4)

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –£–¥–∞–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ –∏–∑ —Ü–µ–ø–æ—á–∫–∏

**–°—Ç–∞—Ä–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –ó–∞–≤—Å–∫–ª–∞–¥
3. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
4. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞  ‚Üê –ó–∞–≤—Å–∫–ª–∞–¥ —É–¥–∞–ª–µ–Ω
3. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ó–∞—è–≤–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –ó–∞–≤—Å–∫–ª–∞–¥ (—ç—Ç–∞–ø 2)

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚è≥ **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞** (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 2)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –î–∏—Ä–µ–∫—Ç–æ—Ä (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 3)

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —ç—Ç–∞–ø–æ–≤

**–°—Ç–∞—Ä–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
3. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –î–∏—Ä–µ–∫—Ç–æ—Ä          ‚Üê –ü–æ–º–µ–Ω—è–ª–∏ –º–µ—Å—Ç–∞–º–∏
3. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
```

**–ó–∞—è–≤–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ (—ç—Ç–∞–ø 2)

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚è≥ **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: –î–∏—Ä–µ–∫—Ç–æ—Ä** (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 2)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 3)

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –†–æ–ª—å —Å–æ–≥–ª–∞—Å—É—é—â–µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–µ

**–°—Ç–∞—Ä–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫  ‚Üê –≠—Ç–∞ —Ä–æ–ª—å
3. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. –°–Ω–∞–±–∂–µ–Ω–µ—Ü
2. –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞  ‚Üê –ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ —É–¥–∞–ª–µ–Ω
3. –î–∏—Ä–µ–∫—Ç–æ—Ä
```

**–ó–∞—è–≤–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ (—ç—Ç–∞–ø 2)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –î–∏—Ä–µ–∫—Ç–æ—Ä (—ç—Ç–∞–ø 3)

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –°–Ω–∞–±–∂–µ–Ω–µ—Ü (—ç—Ç–∞–ø 1)
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ: –ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ (—ç—Ç–∞–ø 2) ‚Üê —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏
- ‚ö†Ô∏è **–ù–∞—á–∏–Ω–∞–µ–º —Å –Ω–∞—á–∞–ª–∞ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏** (—Ç.–∫. —Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)
- ‚è≥ **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: –°–Ω–∞–±–∂–µ–Ω–µ—Ü** (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 1)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 2)
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç: –î–∏—Ä–µ–∫—Ç–æ—Ä (–Ω–æ–≤—ã–π —ç—Ç–∞–ø 3)

---

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–∞—è–≤–∫–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é –∑–∞—è–≤–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å:

```
–î–∞—Ç–∞: 2025-11-09 14:58:30
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [–°–∏—Å—Ç–µ–º–∞]
–°—Ç–∞—Ä—ã–π —Å—Ç–∞—Ç—É—Å: –¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: –û–±–Ω–æ–≤–ª–µ–Ω–∞
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ "–ù–æ–≤–∞—è —Å—Ö–µ–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è".
             –£–¥–∞–ª–µ–Ω–æ 2 –æ–∂–∏–¥–∞—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤, —Å–æ–∑–¥–∞–Ω–æ 3 –Ω–æ–≤—ã—Ö —ç—Ç–∞–ø–æ–≤.
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ö—Ç–æ –º–æ–∂–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è:

‚úÖ **–†–∞–∑—Ä–µ—à–µ–Ω–æ:**
- SUPERADMIN
- –†–æ–ª–∏ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/dashboard/settings/approval-flow`

‚ùå **–ó–∞–ø—Ä–µ—â–µ–Ω–æ:**
- –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### –ö–∞–∫–∏–µ –∑–∞—è–≤–∫–∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è:

‚úÖ **–ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è:**
- –ó–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `IN_PROGRESS` (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è)
- –ó–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `DRAFT` (—á–µ—Ä–Ω–æ–≤–∏–∫–∏)

‚ùå **–ù–ï –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è:**
- –ó–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `APPROVED` (—É–∂–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã)
- –ó–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `REJECTED` (–æ—Ç–∫–ª–æ–Ω–µ–Ω—ã)
- –ó–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `COMPLETED` (–∑–∞–≤–µ—Ä—à–µ–Ω—ã)

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:

‚úÖ **–°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:**
- –í—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã (`APPROVED`)
- –í—Å–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã (`SKIPPED`)
- –í—Å–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã (`REJECTED`)
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

‚ùå **–£–¥–∞–ª—è—é—Ç—Å—è:**
- –¢–æ–ª—å–∫–æ –æ–∂–∏–¥–∞—é—â–∏–µ —ç—Ç–∞–ø—ã (`PENDING`)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
2. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –°–Ω–∞–±–∂–µ–Ω—Ü–∞
3. –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–ø–æ—á–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (–¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —ç—Ç–∞–ø –ø–æ—Å–ª–µ –°–Ω–∞–±–∂–µ–Ω—Ü–∞)
4. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ—à–ª–∞ –Ω–∞ –Ω–æ–≤—ã–π —ç—Ç–∞–ø

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ó–∞—è–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—à–ª–∞ –Ω–∞ –Ω–æ–≤—ã–π —ç—Ç–∞–ø
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å
- ‚úÖ –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å –∑–∞–ø–∏—Å—å –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- ‚úÖ –í –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞—è–≤–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –æ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å 10 –∑–∞—è–≤–æ–∫
2. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å 5 –∑–∞—è–≤–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ –°–Ω–∞–±–∂–µ–Ω—Ü–∞
3. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å 3 –∑–∞—è–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –ø—Ä–æ–µ–∫—Ç–∞
4. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å 2 –∑–∞—è–≤–∫–∏ –¥–æ –∫–æ–Ω—Ü–∞ (—Å—Ç–∞—Ç—É—Å APPROVED)
5. –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–ø–æ—á–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
6. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö 10 –∑–∞—è–≤–æ–∫

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ 8 –∑–∞—è–≤–æ–∫ (—Å–æ —Å—Ç–∞—Ç—É—Å–æ–º IN_PROGRESS) –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ 2 –∑–∞—è–≤–∫–∏ (—Å–æ —Å—Ç–∞—Ç—É—Å–æ–º APPROVED) –Ω–µ —Ç—Ä–æ–Ω—É—Ç—ã
- ‚úÖ –í –ª–æ–≥–∞—Ö 8 –∑–∞–ø–∏—Å–µ–π –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- ‚úÖ –ö–∞–∂–¥–∞—è –∑–∞—è–≤–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —ç—Ç–∞–ø–∞

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–µ

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `project`)
2. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç
- ‚úÖ –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å –∑–∞–ø–∏—Å—å –æ–± –æ—à–∏–±–∫–µ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞—è–≤–∫–∏
- ‚úÖ –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞—è–≤–∫–∏ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ Endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

---

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ backend:

```
[INFO] –ó–∞—è–≤–∫–∞ –ú–ó-2025-00042: –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–≤—à–∏–π - SUPPLY_MANAGER (—ç—Ç–∞–ø 1)
[INFO] –ó–∞—è–≤–∫–∞ –ú–ó-2025-00042: —É–¥–∞–ª–µ–Ω–æ 2 –æ–∂–∏–¥–∞—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤ –∏–∑ —Å—Ç–∞—Ä–æ–π —Ü–µ–ø–æ—á–∫–∏
[INFO] –ó–∞—è–≤–∫–∞ –ú–ó-2025-00042: —Å–æ–∑–¥–∞–Ω–æ 3 –Ω–æ–≤—ã—Ö —ç—Ç–∞–ø–æ–≤ –∏–∑ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏ (–Ω–∞—á–∏–Ω–∞—è —Å –ø–æ–∑–∏—Ü–∏–∏ 1)
[INFO] –ó–∞—è–≤–∫–∞ –ú–ó-2025-00042: –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø: –ó–∞–≤—Å–∫–ª–∞–¥
[INFO] –ó–∞—è–≤–∫–∞ –ú–ó-2025-00042 —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É "–ù–æ–≤–∞—è —Å—Ö–µ–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è"
[INFO] –¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è "–ù–æ–≤–∞—è —Å—Ö–µ–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∑–∞—è–≤–æ–∫: 8 –∏–∑ 8
```

### –õ–æ–≥–∏ –æ—à–∏–±–æ–∫:

```
[ERROR] –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∑–∞—è–≤–∫–∏ –ú–ó-2025-00099: 'NoneType' object has no attribute 'company'
[INFO] –¶–µ–ø–æ—á–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è "–ù–æ–≤–∞—è —Å—Ö–µ–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∑–∞—è–≤–æ–∫: 7 –∏–∑ 8
```

---

## üìå –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ú–ì–ù–û–í–ï–ù–ù–û** –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏
2. **–í—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** - –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è
3. **–ï—Å–ª–∏ —Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–µ**, –∑–∞—è–≤–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –ø–µ—Ä–≤–æ–≥–æ —ç—Ç–∞–ø–∞ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–∏
4. **Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è** –Ω–æ–≤–æ–º—É —Å–æ–≥–ª–∞—Å—É—é—â–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
5. **–ò—Å—Ç–æ—Ä–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** –≤ —Ç–∞–±–ª–∏—Ü–µ `MaterialRequestHistory`
6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ** - –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∫–∞–∂–¥—É—é –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫—É

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend:

- `/backend/apps/material_requests/models.py` (—Å—Ç—Ä–æ–∫–∏ 444-552) ‚Äî –º–µ—Ç–æ–¥ `reconfigure_pending_approvals()`
- `/backend/apps/material_requests/approval_views.py` (—Å—Ç—Ä–æ–∫–∏ 85-135) ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π endpoint `activate()`
- `/backend/apps/material_requests/approval_models.py` ‚Äî –º–æ–¥–µ–ª–∏ ApprovalFlowTemplate, ApprovalStep

### Frontend:

- `/frontend/src/pages/ApprovalFlowSettings.tsx` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
- `/frontend/src/api/approvalFlows.ts` ‚Äî API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–µ–ø–æ—á–∫–∞–º–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- `/MATERIAL_REQUESTS_APPROVAL_FLOW.md` ‚Äî –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ workflow —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
- `/IMPLEMENTATION_MATERIAL_REQUESTS_NEW_LOGIC.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–µ –∑–∞—è–≤–æ–∫
- `/DYNAMIC_APPROVAL_CHAIN_RECONFIGURATION.md` ‚Äî —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç

---

## ‚úÖ –°—Ç–∞—Ç—É—Å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [x] –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ `reconfigure_pending_approvals()` –≤ –º–æ–¥–µ–ª–∏ MaterialRequest
- [x] –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ endpoint `activate()`
- [x] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏)

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-11-09
**–ê–≤—Ç–æ—Ä:** Claude Code
**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** ~30 –º–∏–Ω—É—Ç
**Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω:** ‚úÖ 14:58:27

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–ø–æ—á–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –≤—Å–µ –∑–∞—è–≤–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –Ω–∞ –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –∏—Å—Ç–æ—Ä–∏—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.**

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ:
- ‚ùå –í—Ä—É—á–Ω—É—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞—è–≤–∫–∏
- ‚ùå –ñ–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö –∑–∞—è–≤–æ–∫
- ‚ùå –†–∞–∑–±–∏—Ä–∞—Ç—å—Å—è, –ø–æ—á–µ–º—É –∑–∞—è–≤–∫–∞ "–∑–∞—Å—Ç—Ä—è–ª–∞"

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π —ç—Ç–∞–ø
- ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–æ –Ω–æ–≤–æ–π —Ü–µ–ø–æ—á–∫–µ
- ‚úÖ –£–≤–µ–¥–æ–º–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ —Å–æ–≥–ª–∞—Å—É—é—â–µ–≥–æ
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
