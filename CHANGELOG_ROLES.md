# Changelog: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–æ–≤

## 2025-11-09: –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ –∏ –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫

### ‚ú® –ù–æ–≤—ã–µ —Ä–æ–ª–∏

#### 1. –ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ (CHIEF_POWER_ENGINEER)
- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è:** –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (MANAGEMENT)
- **–ü–æ–∑–∏—Ü–∏—è:** –ü–æ—Å–ª–µ –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- **–ü—Ä–∞–≤–∞:** –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (has_full_access=True)
- **–ò–¢–†:** –î–∞ (–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞–º–µ—á–∞–Ω–∏—è–º–∏)
- **–î–æ—Å—Ç—É–ø:** 100/104 –∫–Ω–æ–ø–æ–∫, 13/13 —Å—Ç—Ä–∞–Ω–∏—Ü

#### 2. –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫ (POWER_ENGINEER)
- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è:** –ò–¢–† –∏ —Å–Ω–∞–±–∂–µ–Ω–∏–µ (ITR_SUPPLY)
- **–ü–æ–∑–∏—Ü–∏—è:** –ü–æ—Å–ª–µ –ü—Ä–æ—Ä–∞–±–∞
- **–ü—Ä–∞–≤–∞:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (has_full_access=False)
- **–ò–¢–†:** –î–∞ (–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞–º–µ—á–∞–Ω–∏—è–º–∏)
- **–î–æ—Å—Ç—É–ø:** 100/104 –∫–Ω–æ–ø–æ–∫, 13/13 —Å—Ç—Ä–∞–Ω–∏—Ü

---

### üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Backend

#### –§–∞–π–ª: `apps/users/models.py`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ User.Role enum (—Å—Ç—Ä–æ–∫–∏ 152-169)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `is_itr` (—Å—Ç—Ä–æ–∫–∞ 323-334)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `is_management_category` (—Å—Ç—Ä–æ–∫–∞ 335-345)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `is_itr_supply_category` (—Å—Ç—Ä–æ–∫–∞ 347-358)

#### –§–∞–π–ª: `apps/core/models.py`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è CHIEF_POWER_ENGINEER –∏ POWER_ENGINEER (—Å—Ç—Ä–æ–∫–∏ 137, 141)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ role_fields –≤ get_accessible_roles() (—Å—Ç—Ä–æ–∫–∏ 208-215)

#### –§–∞–π–ª: `apps/core/admin.py`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ list_filter (—Å—Ç—Ä–æ–∫–∏ 38-39)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ fieldsets (—Å—Ç—Ä–æ–∫–∏ 67, 76)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ role_names (—Å—Ç—Ä–æ–∫–∏ 148, 152)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ changelist_view (—Å—Ç—Ä–æ–∫–∏ 228, 232)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ save_matrix_view (—Å—Ç—Ä–æ–∫–∏ 265-266)

#### –§–∞–π–ª: `config/settings.py`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω DATA_UPLOAD_MAX_NUMBER_FIELDS = 5000 (—Å—Ç—Ä–æ–∫–∞ 344)
  - –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫—É TooManyFieldsSent –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã –¥–æ—Å—Ç—É–ø–∞

#### –ú–∏–≥—Ä–∞—Ü–∏—è:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `0009_add_power_engineer_roles.py`
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

---

### üé® –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ Frontend

#### –§–∞–π–ª: `src/pages/Users.tsx`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω CHIEF_POWER_ENGINEER –≤ ROLES.MANAGEMENT (—Å—Ç—Ä–æ–∫–∞ 107)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω POWER_ENGINEER –≤ ROLES.ITR (—Å—Ç—Ä–æ–∫–∞ 99)

#### –§–∞–π–ª: `src/api/approvalFlows.ts`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ APPROVAL_ROLES (—Å—Ç—Ä–æ–∫–∏ 212, 216)

#### –§–∞–π–ª: `src/pages/Projects.tsx`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ MANAGEMENT_ROLES (—Å—Ç—Ä–æ–∫–∞ 625)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ–ª–∏ –≤ ITR_ROLES –≤ teamMembersData (—Å—Ç—Ä–æ–∫–∞ 984)

#### –§–∞–π–ª: `src/pages/Issues.tsx`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω POWER_ENGINEER –≤ EXECUTOR_ROLES (3 –º–µ—Å—Ç–∞: —Å—Ç—Ä–æ–∫–∏ 402, 414, 444)

#### –§–∞–π–ª: `src/pages/Settings.tsx`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω CHIEF_POWER_ENGINEER –≤ allowedRoles –¥–ª—è Recycle Bin (—Å—Ç—Ä–æ–∫–∞ 15)

#### –§–∞–π–ª: `src/pages/MaterialRequests.tsx`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω POWER_ENGINEER –≤ –ø—Ä–∞–≤–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞ 1403)

---

### üóÑÔ∏è –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞: `core_button_access`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ CHIEF_POWER_ENGINEER (15-—è –ø–æ–∑–∏—Ü–∏—è)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ POWER_ENGINEER (16-—è –ø–æ–∑–∏—Ü–∏—è)
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
  - CHIEF_POWER_ENGINEER ‚Üê —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∞ –æ—Ç CHIEF_ENGINEER
  - POWER_ENGINEER ‚Üê —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∞ –æ—Ç ENGINEER

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ —Ä–æ–ª–µ–π: 14 ‚Üí 16
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π: 117 (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- –ù–æ–≤—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è: 234 (117 –∑–∞–ø–∏—Å–µ–π √ó 2 –Ω–æ–≤—ã–µ —Ä–æ–ª–∏)

---

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞

| –†–æ–ª—å | –ö–Ω–æ–ø–∫–∏ | –°—Ç—Ä–∞–Ω–∏—Ü—ã | –í—Å–µ–≥–æ |
|------|--------|----------|-------|
| CHIEF_POWER_ENGINEER | 100/104 | 13/13 | 113/117 |
| POWER_ENGINEER | 100/104 | 13/13 | 113/117 |

---

### üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ –†–æ–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ User.Role enum
- ‚úÖ –ö–æ–ª–æ–Ω–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –≤ –ë–î (core_button_access)
- ‚úÖ –°–≤–æ–π—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (is_management_category, is_itr_supply_category, is_itr)
- ‚úÖ –°–∏–≥–Ω–∞–ª—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (update_full_access_for_management)
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–æ–≤—ã–µ —Ä–æ–ª–∏
- ‚úÖ Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

#### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î
docker compose exec backend python manage.py shell
from apps.users.models import User
from apps.core.models import ButtonAccess

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π
User.Role.choices  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 16 —Ä–æ–ª–µ–π

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
ButtonAccess.objects.filter(CHIEF_POWER_ENGINEER=True).count()  # 113
ButtonAccess.objects.filter(POWER_ENGINEER=True).count()  # 113
```

---

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –≤–∏–¥–Ω—ã –≤ –∞–¥–º–∏–Ω–∫–µ –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ (is_management_category, is_itr, is_itr_supply_category)
**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Ç—Ä–∏ —Å–≤–æ–π—Å—Ç–≤–∞ –≤ User –º–æ–¥–µ–ª–∏

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: TooManyFieldsSent –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã
**–ü—Ä–∏—á–∏–Ω–∞:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ 2 —Ä–æ–ª–µ–π —É–≤–µ–ª–∏—á–∏–ª–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã –¥–æ ~1900 (–ø—Ä–µ–≤—ã—Å–∏–ª–æ –ª–∏–º–∏—Ç 1000)
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω DATA_UPLOAD_MAX_NUMBER_FIELDS = 5000 –≤ settings.py

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–ø–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
**–ü—Ä–∏—á–∏–Ω–∞:** –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–ª–∞ –ø–æ–ª—è —Å default=False
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∞–≤ –æ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö —Ä–æ–ª–µ–π

---

### üìö –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ `/CLAUDE.md` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–†–æ–ª–µ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
- ‚úÖ `/ROLES_REFERENCE.md` ‚Äî —Å–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ä–æ–ª–µ–π
- ‚úÖ `/CHANGELOG_ROLES.md` ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

### üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ (2025-11-09).
–ö–æ–º–º–∏—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—Ä—É—á–Ω—É—é.

---

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫** –≤—Ö–æ–¥–∏—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ"
   - `is_management_category = True`
   - `has_full_access = True`
   - –î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º

2. **–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫** –≤—Ö–æ–¥–∏—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–ò–¢–†"
   - `is_itr_supply_category = True`
   - `has_full_access = False`
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–æ 13)

3. **–û–±–µ —Ä–æ–ª–∏ —è–≤–ª—è—é—Ç—Å—è –ò–¢–†** (`is_itr = True`)
   - –ú–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–º–µ—á–∞–Ω–∏—è
   - –ú–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏
   - –ú–æ–≥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–º–µ—á–∞–Ω–∏–π

---

**–î–∞—Ç–∞:** 2025-11-09
**–ê–≤—Ç–æ—Ä:** Claude Code
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
