# Generated by Django 4.2.16 on 2025-11-06 16:13

from django.db import migrations


def add_drawing_buttons(apps, schema_editor):
    """
    –î–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —á–µ—Ä—Ç–µ–∂–∞–º–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ projects.

    add_drawing: –î–∏—Ä–µ–∫—Ç–æ—Ä, –ì–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä, –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞,
                 –ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞, –ò–Ω–∂–µ–Ω–µ—Ä, –ü—Ä–æ—Ä–∞–± (7 —Ä–æ–ª–µ–π)

    delete_drawing: –î–∏—Ä–µ–∫—Ç–æ—Ä, –ì–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä, –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞,
                    –ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞, –ò–Ω–∂–µ–Ω–µ—Ä (–ë–ï–ó –ü—Ä–æ—Ä–∞–±–∞ - 6 —Ä–æ–ª–µ–π)
    """
    ButtonAccess = apps.get_model('core', 'ButtonAccess')

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —É–∂–µ —ç—Ç–∏ –∫–Ω–æ–ø–∫–∏
    if ButtonAccess.objects.filter(page='projects', button_key='add_drawing').exists():
        print("‚ö†Ô∏è  –ö–Ω–æ–ø–∫–∞ add_drawing —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
    else:
        # –ö–Ω–æ–ø–∫–∞: –î–æ–±–∞–≤–∏—Ç—å —á–µ—Ä—Ç—ë–∂
        ButtonAccess.objects.create(
            access_type='button',
            company=None,  # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
            page='projects',
            button_key='add_drawing',
            button_name='–î–æ–±–∞–≤–∏—Ç—å —á–µ—Ä—Ç—ë–∂',
            description='–ü—Ä–∞–≤–æ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä—Ç–µ–∂–µ–π –∫ –ø—Ä–æ–µ–∫—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF',
            default_access=False,
            SUPERADMIN=True,
            DIRECTOR=True,
            CHIEF_ENGINEER=True,
            PROJECT_MANAGER=True,
            SITE_MANAGER=True,
            ENGINEER=True,
            FOREMAN=True,  # –ü—Ä–æ—Ä–∞–± –ú–û–ñ–ï–¢ –¥–æ–±–∞–≤–ª—è—Ç—å —á–µ—Ä—Ç–µ–∂–∏
            MASTER=False,
            SUPERVISOR=False,
            CONTRACTOR=False,
            OBSERVER=False,
            SUPPLY_MANAGER=False,
            WAREHOUSE_HEAD=False,
            SITE_WAREHOUSE_MANAGER=False
        )
        print("‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ add_drawing –¥–ª—è projects")

    if ButtonAccess.objects.filter(page='projects', button_key='delete_drawing').exists():
        print("‚ö†Ô∏è  –ö–Ω–æ–ø–∫–∞ delete_drawing —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
    else:
        # –ö–Ω–æ–ø–∫–∞: –£–¥–∞–ª–∏—Ç—å —á–µ—Ä—Ç—ë–∂
        ButtonAccess.objects.create(
            access_type='button',
            company=None,  # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
            page='projects',
            button_key='delete_drawing',
            button_name='–£–¥–∞–ª–∏—Ç—å —á–µ—Ä—Ç—ë–∂',
            description='–ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä—Ç–µ–∂–µ–π –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞',
            default_access=False,
            SUPERADMIN=True,
            DIRECTOR=True,
            CHIEF_ENGINEER=True,
            PROJECT_MANAGER=True,
            SITE_MANAGER=True,
            ENGINEER=True,
            FOREMAN=False,  # –ü—Ä–æ—Ä–∞–± –ù–ï –ú–û–ñ–ï–¢ —É–¥–∞–ª—è—Ç—å —á–µ—Ä—Ç–µ–∂–∏
            MASTER=False,
            SUPERVISOR=False,
            CONTRACTOR=False,
            OBSERVER=False,
            SUPPLY_MANAGER=False,
            WAREHOUSE_HEAD=False,
            SITE_WAREHOUSE_MANAGER=False
        )
        print("‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ delete_drawing –¥–ª—è projects")


def remove_drawing_buttons(apps, schema_editor):
    """–û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è —á–µ—Ä—Ç–µ–∂–µ–π"""
    ButtonAccess = apps.get_model('core', 'ButtonAccess')

    deleted_count = ButtonAccess.objects.filter(
        page='projects',
        button_key__in=['add_drawing', 'delete_drawing']
    ).delete()[0]

    print(f"üîÑ –û—Ç–∫–∞—Ç: —É–¥–∞–ª–µ–Ω–æ {deleted_count} –∫–Ω–æ–ø–æ–∫ –¥–ª—è —á–µ—Ä—Ç–µ–∂–µ–π")


class Migration(migrations.Migration):

    dependencies = [
        ("core", "0006_update_delete_button_add_site_manager"),
    ]

    operations = [
        migrations.RunPython(add_drawing_buttons, remove_drawing_buttons),
    ]
