# üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –î–ï–ü–õ–û–Æ: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏"

**–î–∞—Ç–∞**: 2025-11-08
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—á–∞–Ω–∏–µ"
**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞—Ç—å —Ä–æ–ª—å `MASTER` –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π –≤ API

---

## üìã –ß–¢–û –ë–´–õ–û –ò–ó–ú–ï–ù–ï–ù–û

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. `backend/apps/users/views.py` - —Å—Ç—Ä–æ–∫–∞ 247-248

### –°—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```python
# –ë–´–õ–û:
FORBIDDEN_ROLES = ['CONTRACTOR', 'SUPERVISOR', 'OBSERVER', 'MASTER']

# –°–¢–ê–õ–û:
FORBIDDEN_ROLES = ['CONTRACTOR', 'SUPERVISOR', 'OBSERVER']
```

---

## üîß –®–ê–ì–ò –î–õ–Ø –î–ï–ü–õ–û–Ø –ù–ê –ü–†–û–î–ê–ö–®–ù

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ SSH (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh user@stroyka.asia

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/checksite

# 3. –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ Git
git pull origin main

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
docker compose restart backend

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs backend --tail 50

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker compose ps
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ CI/CD (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π)

```bash
# 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
git add backend/apps/users/views.py
git commit -m "fix: —É–±—Ä–∞—Ç—å MASTER –∏–∑ FORBIDDEN_ROLES –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π"

# 2. –ó–∞–ø—É—à–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É
git push origin main

# 3. –î–æ–∂–¥–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è –≤ CI/CD –ø–∞–Ω–µ–ª–∏
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
docker compose ps

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ backend –≤ —Å—Ç–∞—Ç—É—Å–µ "Up"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend:

```bash
docker compose logs backend --tail 30

# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞: "Listening on TCP address 0.0.0.0:8000"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É API:

–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∏–ª–∏ —á–µ—Ä–µ–∑ curl):
```
https://stroyka.asia/api/auth/users/
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω).

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:

1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å https://stroyka.asia
2. ‚úÖ –í–æ–π—Ç–∏ –ø–æ–¥ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é (–ù–ï superadmin)
3. ‚úÖ –ü–µ—Ä–µ–π—Ç–∏: **–ó–∞–º–µ—á–∞–Ω–∏—è** ‚Üí **–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—á–∞–Ω–∏–µ**
4. ‚úÖ –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
5. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ **"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å"**
6. ‚úÖ **–ü–†–û–í–ï–†–ò–¢–¨**: –î–æ–ª–∂–Ω—ã –±—ã—Ç—å **–î–í–ï –≥—Ä—É–ø–ø—ã**:
   - "–ü–æ–¥—Ä—è–¥—á–∏–∫–∏"
   - "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏" ‚Üê **–¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è**

**–í –≥—Ä—É–ø–ø–µ "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏" –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å**:
- –ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞ (SITE_MANAGER)
- –ü—Ä–æ—Ä–∞–± (FOREMAN)
- –ú–∞—Å—Ç–µ—Ä (MASTER) ‚Üê **—Ä–∞–Ω–µ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª**

---

## üîÑ –û–¢–ö–ê–¢ –ò–ó–ú–ï–ù–ï–ù–ò–ô (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é:

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh user@stroyka.asia

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/checksite

# 3. –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git revert HEAD

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
docker compose restart backend
```

### –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥:

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `backend/apps/users/views.py` —Å—Ç—Ä–æ–∫—É 248:

```python
# –í–µ—Ä–Ω—É—Ç—å:
FORBIDDEN_ROLES = ['CONTRACTOR', 'SUPERVISOR', 'OBSERVER', 'MASTER']
```

–ó–∞—Ç–µ–º:
```bash
docker compose restart backend
```

---

## üìä –ö–û–ù–¢–†–û–õ–¨–ù–´–ô –°–ü–ò–°–û–ö

- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –õ–æ–≥–∏ backend –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–æ–∫
- [ ] API `/api/auth/users/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏" –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
- [ ] –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –º–∞—Å—Ç–µ—Ä–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∑–∞–º–µ—á–∞–Ω–∏—è
- [ ] –ó–∞–º–µ—á–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å –º–∞—Å—Ç–µ—Ä–æ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

---

## üìù –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ **–Ω–µ –≤–ª–∏—è–µ—Ç** –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –†–æ–ª–∏ `CONTRACTOR`, `SUPERVISOR`, `OBSERVER` –æ—Å—Ç–∞—é—Ç—Å—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ API –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ **–Ω–µ –≤–ª–∏—è–µ—Ç** –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î **–Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è**
- ‚úÖ –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π **–Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å**

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- ‚úÖ Frontend **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç** –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç** –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è **–Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã**

---

## üÜò –ü–û–î–î–ï–†–ñ–ö–ê

### –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend**:
   ```bash
   docker compose logs backend --tail 100
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**:
   ```bash
   docker compose ps
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API**:
   ```bash
   curl -I https://stroyka.asia/api/auth/users/
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã** (–∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π):
   ```bash
   docker compose down
   docker compose up -d
   ```

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `ISSUE_INTERNAL_EXECUTORS.md`
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã: –°–º. —Ä–∞–∑–¥–µ–ª "–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê" –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
